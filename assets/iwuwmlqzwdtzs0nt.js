const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/dpbbn488dim7abpr.js","assets/izh0i1dfnf8ev7x1.js","assets/hggowi1ggrzb09yc.js","assets/root-ko7rpr3h.css"])))=>i.map(i=>d[i]);
import{d as R,E as I,ae as H,bh as U,bi as V,bY as G,Q as A,cn as se,D as te,cc as P,cj as X,bW as y,bv as ae,bw as re,ar as ne,gw as ie,h as oe,f4 as le}from"./hggowi1ggrzb09yc.js";import{j as e,c as D,r as d,M as i,a$ as K,u as Z,a as J,b as _}from"./izh0i1dfnf8ev7x1.js";import{m as W}from"./cc6fxkf4gd4wikbo.js";import{bQ as Y,J as ce,f3 as de,il as q,eK as a,eO as ue,im as L,ab as T,cW as me,by as ge}from"./fc2hzad6rtrm7s5f.js";import{A as pe}from"./ilf9q9cb2tzq42nz.js";import{a as xe,b as he}from"./n9asr46t70a9bw5r.js";import{V as fe}from"./d3y72ugnrmac5z1v.js";import{u as je}from"./fxsxqni4put5xd2y.js";import"./hjbk0a4n40hheieo.js";import"./in3ze5ugryldzaj2.js";import"./8nxoaz0vb9p890un.js";import"./lb1py1igp6jzrtce.js";import"./ab6tyx2xygyb56l3.js";import"./ldmmkc4tdjcw782k.js";import"./gj7td52smypxg2g9.js";import"./d60wxt0885pttnzn.js";import"./cn4a1z79lddhqdbi.js";function ee({className:s,inputClassName:r,value:o,onChange:g,placeholder:p}){return e.jsxs("div",{className:R("relative",s),children:[e.jsx(Y,{className:"icon-sm absolute left-2 top-1/2 -translate-y-1/2 transform text-token-text-tertiary"}),e.jsx("input",{type:"text",value:o,onChange:g,placeholder:p,className:R("rounded-lg border border-gray-200 pl-8 placeholder:text-gray-500 dark:border-gray-600 dark:bg-gray-700",r),autoComplete:"off"})]})}const B=1e3;function ye({group:s,isOpen:r,onClose:o}){const g=D(),p=I(),u=g.formatMessage({id:"workspaceSettings.groups.addMember",defaultMessage:"Add members to the {groupName} group"},{groupName:s.name}),h=H(),[j,x]=d.useState([]),[f,c]=d.useState(!1);async function S(){const M=h?.getWorkspaceId();if(!M)throw new Error("No workspace ID found");c(!0);const N=await A.bulkAddWorkspaceGroupUsers(M,s.id,j);p.success(g.formatMessage({id:"yU4Zf0",defaultMessage:"Added {numUsers} users to the group"},{numUsers:N.added_group_users.length})),o?.(),c(!1)}return e.jsxs(U,{isOpen:r,onClose:o??V,title:u,type:"success",showCloseButton:!0,primaryButton:e.jsx(G,{onClick:S,disabled:j.length===0||j.length>B,loading:f,children:e.jsx(i,{id:"EpbOzA",defaultMessage:"Add users to group"})}),children:[e.jsx(Me,{onChange:x}),j.length>B&&e.jsx("div",{className:"mt-2 text-sm text-token-text-error",children:e.jsx(i,{id:"9lp0Tc",defaultMessage:"Email list is limited to {maxEmails} users at once",values:{maxEmails:B}})})]})}function Me({onChange:s}){const[r,o]=d.useState("");return e.jsxs("div",{className:"flex flex-col space-y-4",children:[e.jsxs("label",{htmlFor:"group-email-paste",children:[e.jsx(i,{id:"qvGcSC",defaultMessage:"Emails"}),e.jsx("br",{}),e.jsx("span",{className:"text-sm text-token-text-tertiary",children:e.jsx(i,{id:"Fhd+5h",defaultMessage:"Paste email addresses here, one per line:"})})]}),e.jsx(ce,{id:"group-email-paste",className:"h-[250px] text-sm",value:r,onChange:g=>{o(g.target.value),s(we(g.target.value))},placeholder:`jean@example.com
joohyun@example.com
muhammed@example.com
susan@example.com`})]})}function we(s){return s.split(`
`).map(r=>r.trim()).filter(r=>r.length>0).filter(r=>fe.test(r))}function be({group:s,isOpen:r,onClose:o}){const p=D().formatMessage({id:"workspaceSettings.groups.addMember",defaultMessage:"Add members to the {groupName} group"},{groupName:s.name}),h=H()?.getWorkspaceId(),[j,x]=d.useState(""),[f,c]=d.useState(0),{data:S}=de(h,f*q,j,q,K),[M,N]=d.useState([]),[C,w]=d.useState([]),[b,k]=d.useState("interactive"),m=S?Math.ceil(S.total??0/q):0;async function t(n){w(l=>[...l,n]);try{await Se(h,s.id,n),N(l=>[...l,n])}catch(l){te.addError(l)}finally{w(l=>l.filter(v=>v!==n))}}return b==="batch"?e.jsx(ye,{group:s,isOpen:r,onClose:o}):e.jsx(U,{type:"warning",isOpen:r,onClose:o??V,title:p,size:"custom",className:"max-w-screen-md",showCloseButton:!0,primaryButton:e.jsx(G,{onClick:o,children:e.jsx(i,{id:"0NAzDq",defaultMessage:"Done"})}),children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex flex-row justify-between",children:[e.jsx("p",{children:p}),e.jsx(G,{onClick:()=>{k("batch")},color:"secondary",children:e.jsx(i,{id:"5GPldp",defaultMessage:"Bulk add users"})})]}),e.jsx(ee,{value:j,inputClassName:"w-full",onChange:n=>{x(n.target.value)}}),e.jsxs(a.Root,{className:"min-w-full",children:[e.jsxs(a.Header,{children:[e.jsx(a.HeaderCell,{children:e.jsx(i,{id:"workspaceSettings.groups.addMember.name",defaultMessage:"Name"})}),e.jsx(a.HeaderCell,{children:e.jsx(i,{id:"workspaceSettings.groups.addMember.email",defaultMessage:"Email"})}),e.jsx(a.HeaderCell,{})]}),e.jsx(a.Body,{children:S?.items.map(n=>e.jsxs(a.Row,{children:[e.jsx(a.Cell,{children:n.name}),e.jsx(a.Cell,{children:n.email}),e.jsx(a.Cell,{textAlign:"right",className:"pr-1",children:e.jsx(G,{size:"small",color:"secondary",disabled:C.includes(n.id),onClick:()=>{M.includes(n.id)||t(n.id)},icon:M.includes(n.id)?se:ue,children:M.includes(n.id)?e.jsx(i,{id:"workspaceSettings.groups.addMember.addButton",defaultMessage:"Added"}):e.jsx(i,{id:"workspaceSettings.groups.addMember.addedButton",defaultMessage:"Add"})})})]},n.id))})]}),e.jsx("div",{className:"flex flex-row justify-center",children:e.jsx(L,{currentPage:f,onChangeIndex:n=>{c(n)},length:m})})]})})}async function Se(s,r,o){await A.addWorkspaceGroupUser(s,r,o)}const O=10;function Ne({workspaceId:s,group:r,readOnly:o}){const g=D(),[p,u]=d.useState(!1),[h,j]=d.useState(""),[x,f]=d.useState(0),{data:c,isLoading:S,isPlaceholderData:M}=Z({queryKey:[s,"groups",r.id,h,`members-page-${x}`],queryFn:()=>A.listWorkspaceGroupMembers(s,r.id,h,x*O),placeholderData:K}),[N,C]=d.useState(!1),w=d.useRef(null),b=J();d.useEffect(()=>{p&&w.current&&w.current.focus()},[p]);const{mutateAsync:k}=_({mutationFn:async m=>await A.removeWorkspaceGroupMember(s,r.id,m),onMutate:m=>{b.cancelQueries({queryKey:[s,"groups",r.id]});const t=c;return b.setQueryData([s,"groups",r.id,h,`members-page-${x}`],n=>n?{...n,items:n.items.filter(l=>l.id!==m),total:n.total-1}:{limit:10,offset:0,items:[],total:0}),{previousData:t}},onError:(m,t,n)=>{b.setQueryData([s,"groups",r.id,`members-page-${x}`],n?.previousData),b.invalidateQueries({queryKey:[s,"groups",r.id]})},onSettled:async()=>{await new Promise(m=>setTimeout(m,1e3)),b.invalidateQueries({queryKey:[s,"groups"]})}});return e.jsxs("div",{className:"flex w-full flex-col",children:[e.jsxs("div",{className:"flex flex-row items-center",children:[e.jsx("div",{className:"border-token-border-dark mt-3 inline-block h-8 grow-0 border-b-2 text-sm font-semibold",children:e.jsx(i,{id:"workspaceSettings.groups.membersTableTitle",defaultMessage:"Group members"})}),e.jsx("div",{className:"grow"}),e.jsx(P,{label:g.formatMessage({id:"workspaceSettings.groups.searchButtonTooltip",defaultMessage:"Search members"}),children:e.jsx("div",{className:"cursor-pointer p-2",onClick:()=>{u(!0)},children:e.jsx(Y,{className:"icon-sm"})})}),e.jsx("input",{type:"text",ref:w,placeholder:g.formatMessage({id:"workspaceSettings.groups.searchMembers",defaultMessage:"Filter by name or email..."}),className:R("bg-token-surface-primary dark:bg-token-surface-secondary border-none px-0 transition-width duration-300 ease-in-out focus:ring-0",p?"w-64":"w-0"),value:h,onChange:()=>{f(0),j(w.current?.value??"")}})]}),e.jsxs(a.Root,{className:"min-w-full",children:[e.jsxs(a.Header,{children:[e.jsx(a.HeaderCell,{children:e.jsx(i,{id:"workspaceSettings.groups.memberName",defaultMessage:"Name"})}),e.jsx(a.HeaderCell,{children:e.jsx(i,{id:"workspaceSettings.groups.email",defaultMessage:"Email"})}),e.jsx(a.HeaderCell,{})]}),e.jsx(a.Body,{className:S||M?"opacity-50":void 0,children:c==null?e.jsx(a.Row,{children:e.jsx(a.Cell,{colSpan:3,children:e.jsx(X,{})})}):c.items.length===0?e.jsx(a.Row,{children:e.jsx(a.Cell,{colSpan:3,children:h===""?e.jsx(i,{id:"workspaceSettings.groups.noMembers",defaultMessage:"No members"}):e.jsx(i,{id:"workspaceSettings.groups.noMembersForSearch",defaultMessage:"No members matched the filter"})})}):c.items.map(m=>e.jsxs(a.Row,{children:[e.jsx(a.Cell,{children:e.jsx("span",{className:"ml-3",children:m.name})}),e.jsx(a.Cell,{children:m.email}),e.jsx(a.Cell,{textAlign:"right",children:!o&&(r.is_scim_managed?e.jsx(y.Root,{children:e.jsx(y.Trigger,{disabled:!0,children:e.jsx(P,{sideOffset:0,label:g.formatMessage(W.managedViaSCIMTooltip),className:"flex",side:"right",children:e.jsx(T,{className:"icon-sm"})})})}):e.jsxs(y.Root,{children:[e.jsx(y.Trigger,{className:"-my-2",children:e.jsx(T,{className:"icon-sm"})}),e.jsx(y.Portal,{children:e.jsx(y.Content,{children:e.jsx(y.Item,{onClick:()=>k(m.id),children:e.jsx(i,{id:"workspaceSettings.groups.removeMember",defaultMessage:"Remove member"})})})})]}))})]},m.id))})]}),e.jsxs("div",{className:"my-2 flex flex-row justify-center",children:[!o&&!r.is_scim_managed&&e.jsx(G,{color:"secondary",onClick:()=>C(!0),children:e.jsx(i,{id:"workspaceSettings.groups.addMemberButton",defaultMessage:"Add member"})}),!o&&r.is_scim_managed&&e.jsx(P,{label:g.formatMessage(W.managedViaSCIMTooltip),side:"right",sideOffset:0,children:e.jsx(G,{color:"secondary",disabled:!0,children:e.jsx(i,{id:"workspaceSettings.groups.addMemberButton",defaultMessage:"Add member"})})}),e.jsx("div",{className:"grow"}),c&&c.items.length>0&&e.jsx(L,{currentPage:x,onChangeIndex:m=>{f(m)},length:Math.ceil(c.total/O)})]}),N&&e.jsx(be,{isOpen:!0,onClose:()=>{b.invalidateQueries({queryKey:[s,"groups"]}),C(!1)},group:r})]})}const Ce=ae(()=>re(()=>import("./dpbbn488dim7abpr.js"),__vite__mapDeps([0,1,2,3])).then(s=>s.DirectorySyncResourceManagedIndication)),F=10;function ve({workspaceId:s}){const r=D(),o=I(),g=H(),p=!(g?.isAdminOfAccount()||g?.isOwnerOfAccount()),u=J(),[h,j]=d.useState(""),[x,f]=d.useState(0),{data:c,isLoading:S,isPlaceholderData:M}=Z({queryKey:h===""?[s,"groups",`page-${x}`]:[s,"groups","filtered",h,`page-${x}`],queryFn:()=>A.getWorkspaceGroups(s,{query:h,offset:x*F}),placeholderData:K}),[N,C]=d.useState(!1),w=t=>{t&&(f(0),j("")),C(t)},{mutateAsync:b}=_({mutationFn:async({workspaceId:t,name:n})=>await A.createWorkspaceGroup(t,n),onMutate:({workspaceId:t,name:n})=>{u.cancelQueries({queryKey:[t,"groups"]});const l=c;return u.setQueryData([t,"groups","page-0"],v=>(v||(v={limit:10,offset:0,items:[],total:0}),{...v,items:[{id:"new",name:n,num_members:0,created_time:""},...v.items.slice(0,9)]})),{previousGroups:l}},onError:(t,n,l)=>{u.setQueryData([s,"groups","page-0"],l?.previousGroups),u.invalidateQueries({queryKey:[s,"groups"]}),t.message==="Group with this name already exists."&&o.warning(r.formatMessage({id:"workspaceSettings.groups.duplicateName",defaultMessage:"Group with this name already exists"}),{duration:2})},onSettled:async()=>{await new Promise(t=>setTimeout(t,1e3)),u.invalidateQueries({queryKey:[s,"groups"]})}}),{mutateAsync:k}=_({mutationFn:async t=>await A.deleteWorkspaceGroup(s,t),onMutate:t=>{u.cancelQueries({queryKey:[s,"groups","page-0"]});const n=c;return u.setQueryData([s,"groups","page-0"],l=>(l||(l={items:[]}),{...l,items:l.items.filter(v=>v.id!==t)})),{previousGroups:n}},onError:(t,n,l)=>{u.setQueryData([s,"groups","page-0"],l?.previousGroups),u.invalidateQueries({queryKey:[s,"groups"]})},onSettled:async()=>{await new Promise(t=>setTimeout(t,1e3)),u.invalidateQueries({queryKey:[s,"groups"]})}}),{mutateAsync:m}=_({mutationFn:async({workspaceId:t,groupID:n,name:l})=>await A.updateWorkspaceGroup(t,n,l),onMutate:({workspaceId:t,groupID:n,name:l})=>{const v=u.getQueryData([t,"groups",`page-${x}`]);return u.setQueryData([t,"groups",`page-${x}`],E=>(E||(E={items:[]}),{...E,items:E.items.map(Q=>Q.id===n?{...Q,name:l}:Q)})),{previousGroups:v}},onError:(t,n,l)=>{u.setQueryData([n,"groups",`page-${x}`],l?.previousGroups),t.message==="Group with this name already exists."&&o.warning(r.formatMessage({id:"workspaceSettings.groups.duplicateName",defaultMessage:"Group with this name already exists"}),{duration:2})},onSettled:async()=>{await new Promise(t=>setTimeout(t,1e3)),u.invalidateQueries({queryKey:[s,"groups"]})}});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-3 mt-6 flex flex-row justify-between gap-2",children:[e.jsx(ee,{inputClassName:"w-[250px]",value:h,onChange:t=>{j(t.target.value),f(0)},placeholder:r.formatMessage({id:"workspaceSettings.groups.search",defaultMessage:"Search group name"})}),!p&&e.jsx(G,{onClick:()=>w(!0),children:e.jsx(i,{id:"workspaceSettings.groups.create",defaultMessage:"Create group"})})]}),e.jsxs("div",{children:[e.jsxs(a.Root,{className:"min-w-full",children:[e.jsxs(a.Header,{children:[e.jsx(a.HeaderCell,{}),e.jsx(a.HeaderCell,{children:e.jsx(i,{id:"workspaceSettings.groups.groupName",defaultMessage:"Group name"})}),e.jsx(a.HeaderCell,{children:e.jsx(i,{id:"workspaceSettings.groups.members",defaultMessage:"Members"})}),e.jsx(a.HeaderCell,{children:e.jsx(i,{id:"workspaceSettings.groups.created",defaultMessage:"Created"})}),e.jsx(a.HeaderCell,{})]}),e.jsxs(a.Body,{className:R((S||M)&&"opacity-50"),children:[N&&e.jsx($,{group:"new",workspaceId:s,onChangeName:async t=>{t.trim()!==""&&(b({workspaceId:s,name:t}),w(!1))},onDelete:()=>null,readOnly:p}),c==null?e.jsx(a.Row,{children:e.jsx(a.Cell,{colSpan:5,textAlign:"center",children:e.jsx(X,{})})}):c.items.length===0?e.jsx(a.Row,{children:e.jsx(a.Cell,{colSpan:5,textAlign:"center",children:h===""?e.jsx(i,{id:"workspaceSettings.groups.noGroups",defaultMessage:"No groups found."}):e.jsx(i,{id:"workspaceSettings.groups.noGroupsWithFIlter",defaultMessage:"No groups found. Try changing the search query."})})}):c.items.map(t=>e.jsx($,{group:t,workspaceId:s,onDelete:k,onChangeName:async n=>{m({workspaceId:s,groupID:t.id,name:n})},readOnly:p},t.id))]})]}),c&&e.jsx("div",{className:"text-center",children:e.jsx(L,{length:Math.ceil(c.total/F),currentPage:Math.min(x,Math.ceil(c.total/F)),onChangeIndex:t=>f(t)})})]})]})}function ke({currentWorkspaceId:s}){const r=D();return e.jsxs(e.Fragment,{children:[e.jsx(me,{children:e.jsx("title",{children:r.formatMessage(z.title)})}),e.jsx(xe,{title:r.formatMessage(z.title),subtitle:e.jsx(i,{id:"NDDzzF",defaultMessage:"Only workspace admins can edit these settings."})}),e.jsx(he,{showSpinner:!1,children:e.jsx(ve,{workspaceId:s})})]})}function $({group:s,workspaceId:r,onChangeName:o,onDelete:g,readOnly:p}){const u=D(),{value:h}=ne("2091463435"),[j,x]=d.useState(!1),[f,c]=d.useState(s==="new"?"":s.name),[S,M]=d.useState(!1),[N,C]=d.useState(s==="new"),[w,b]=d.useState(null),k=d.useRef(null);d.useEffect(()=>{(s==="new"||N)&&k.current?.focus()},[s,N]);const m=async()=>{if(f.trim()===""){c(s==="new"?"":s.name),C(!1),M(!1);return}o&&(M(!0),await o(f)),M(!1),C(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs(a.Row,{onClick:()=>x(t=>!t),className:"hover:bg-token-surface-secondary cursor-pointer",children:[e.jsx(a.Cell,{children:e.jsx(pe,{checked:j})}),e.jsxs(a.Cell,{children:[s==="new"||N?e.jsx(ge,{ariaLabel:u.formatMessage({id:"RgbuwE",defaultMessage:"New group name"}),ref:k,name:"newGroupName",value:f,disabled:S,placeholder:u.formatMessage({id:"workspaceSettings.groups.groupNamePlaceholder",defaultMessage:"New group name..."}),onChange:t=>c(t.target.value),onBlur:()=>{f!==(s==="new"?"":s.name)&&m()},onPressEnter:m}):s.name,h&&s!=="new"&&s.is_scim_managed&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"flex-grow"}),e.jsx(Ce,{})]})]}),e.jsx(a.Cell,{children:e.jsx(i,{id:"workspaceSettings.groups.memberCount",defaultMessage:"{count} members",values:{count:s==="new"?"0":s.num_members}})}),e.jsx(a.Cell,{children:s==="new"||!s.created_time?"":e.jsx(ie,{value:s.created_time,year:"numeric",month:"long",day:"numeric"})}),e.jsx(a.Cell,{textAlign:"right",children:s!=="new"&&!p&&(s.is_scim_managed?e.jsx(y.Root,{children:e.jsx(y.Trigger,{disabled:!0,children:e.jsx(P,{sideOffset:0,label:u.formatMessage(W.managedViaSCIMTooltip),className:"flex",side:"right",children:e.jsx(T,{className:"icon-sm"})})})}):e.jsxs(y.Root,{children:[e.jsx(y.Trigger,{className:"-my-2",children:e.jsx(T,{className:"icon-sm"})}),e.jsx(y.Portal,{children:e.jsxs(y.Content,{children:[e.jsx(y.Item,{onClick:t=>{C(!0),setTimeout(()=>{k.current?.focus()},120),t.stopPropagation()},children:e.jsx(i,{id:"workspaceSettings.groups.changeName",defaultMessage:"Edit name"})}),e.jsx(y.Item,{onClick:t=>{b(s),t.stopPropagation()},children:e.jsx(i,{id:"workspaceSettings.groups.edit",defaultMessage:"Delete group"})})]})})]}))})]}),j&&s!=="new"&&e.jsx(a.Row,{children:e.jsx(a.Cell,{colSpan:5,className:"pl-8",children:e.jsx(Ne,{group:s,workspaceId:r,readOnly:p})})}),w&&e.jsx(Ge,{group:w,onDelete:g,onClose:()=>b(null)})]})}function Ge({group:s,onDelete:r,onClose:o}){const p=D().formatMessage({id:"workspaceSettings.groups.deleteGroupTitle",defaultMessage:"Delete group {groupName}?"},{groupName:s.name});return e.jsx(U,{type:"warning",isOpen:!0,onClose:o,title:p,showCloseButton:!0,primaryButton:e.jsx(G,{color:"danger",onClick:async()=>{r(s.id),o()},children:e.jsx(i,{id:"workspaceSettings.groups.confirmDelete",defaultMessage:"Delete"})}),secondaryButton:e.jsx(G,{onClick:o,color:"secondary",children:e.jsx(i,{id:"workspaceSettings.groups.cancelDelete",defaultMessage:"Cancel"})}),children:e.jsx("p",{children:e.jsx(i,{id:"workspaceSettings.groups.deleteGroupWarning",defaultMessage:'Are you sure you want to delete the "{groupName}" group? This action cannot be undone.',values:{groupName:s.name}})})})}const z=oe({title:{id:"admin.groupsSettings.title",defaultMessage:"Groups"}}),$e=le(function(){const r=je();return e.jsx(ke,{...r})});export{$e as default};
//# sourceMappingURL=iwuwmlqzwdtzs0nt.js.map
