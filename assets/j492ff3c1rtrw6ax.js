const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/flfltvryunm0il4c.js","assets/izh0i1dfnf8ev7x1.js","assets/hggowi1ggrzb09yc.js","assets/root-ko7rpr3h.css","assets/fc2hzad6rtrm7s5f.js","assets/conversation-small-lgvqkxxm.css"])))=>i.map(i=>d[i]);
import{E as te,bh as q,bY as $,h as _,br as J,di as M,cj as se,d as ie,Q as ne,bv as oe,bw as re,dw as K,ae as le,al as W,ar as L,c5 as F,fQ as de,u as ce,v as Q,bW as i,P as me,co as ue,b$ as ge,H as he}from"./hggowi1ggrzb09yc.js";import{c as E,r as C,j as e,M as o,b as N,a as R,d as xe}from"./izh0i1dfnf8ev7x1.js";import{c7 as fe,I as D,H as f,J as pe,df as k,U as x,gv as ve,dH as je,dI as Se,dJ as we,bP as ye,gw as X,gx as be,ge as Ge,gy as Ce,gz as Ie,gA as ze,bC as U,d7 as Y,a8 as Me,a7 as ke,bE as Pe,gk as Te,aB as Ae,gj as Fe,f7 as _e,dD as Ee,gB as Z,bk as Ne,V as De,bn as Le,gC as Ue,ek as Be,aj as He,gD as B,bL as T,gE as H,f6 as Oe,eM as Ve}from"./fc2hzad6rtrm7s5f.js";import{G as A}from"./ddzilicy6qtleo90.js";import{R as qe}from"./ozluxx1s2jsn9j26.js";import{S as $e}from"./c9ymhpumxb2611xi.js";import{S as Je}from"./gq56vmyv6ftpm8ay.js";import{S as Ke}from"./ki2fnq5gqslif1ka.js";import{c as We,d as Qe}from"./hy4byupilmyf57n0.js";import"./8nxoaz0vb9p890un.js";import"./j7xrr4x8o3ssozmz.js";import"./jr1b41w4nuv00isi.js";import"./nn6gjrst5lwozesx.js";function Re(a){return N({mutationFn:async({message:t,includeFrom:s})=>{await k.sendFeedbackEmail(a,t,s)}})}const Xe=({gizmo:a})=>{const t=fe(),s=D(f.GPTFeedbackEmail),n=()=>x.closeModal(f.GPTFeedbackEmail),r=E(),j=te(),[d,l]=C.useState(""),[p,c]=C.useState(!0),u=Re(a.gizmo.id),h=d.length===0;return e.jsx(q,{type:"success",title:r.formatMessage(z.title,{name:a.gizmo.display.name}),isOpen:s,onClose:n,size:"custom",showCloseButton:!0,className:"max-w-xl overflow-y-auto",hideSeparator:!0,children:e.jsx("div",{className:"flex flex-row",children:e.jsxs("div",{className:"-mt-4 flex flex-grow flex-col space-y-4",children:[e.jsx(pe,{className:"mb-1 w-full resize-none overflow-y-auto rounded-md bg-transparent focus:border-gray-200 focus:ring-gray-200 dark:focus:border-white dark:focus:ring-white",placeholder:`Write feedback about ${a.gizmo.display.name}...`,value:d,rows:4,onChange:m=>l(m.target.value)}),e.jsxs("div",{className:"flex flex-row items-center space-x-2 self-start",children:[e.jsx("input",{type:"checkbox",checked:p,onChange:m=>c(m.target.checked)}),t&&e.jsx("span",{className:"text-sm",children:e.jsx(o,{...z.includeFrom,values:{email:e.jsx("strong",{children:t.email})}})})]}),e.jsx($,{color:"primary",disabled:h,onClick:async()=>{await u.mutateAsync({message:d,includeFrom:p}),j.success(r.formatMessage(z.successToast),{duration:3}),n()},children:e.jsx(o,{...z.send,values:{name:a.gizmo.author.display_name}})})]})})})},z=_({title:{id:"GizmoFeedbackEmailModal.title",defaultMessage:"Feedback about {name}"},send:{id:"GizmoFeedbackEmailModal.sendTo",defaultMessage:"Send To {name}"},successToast:{id:"GizmoFeedbackEmailModal.successToast",defaultMessage:"Feedback sent"},includeFrom:{id:"GizmoFeedbackEmailModal.includeFrom",defaultMessage:"Include my email address {email}"}});function Ye(a){const t=R();return N({mutationFn:async({actionId:s,domain:n,settings:r})=>k.upsertUserActionSettings(s,n,r),onSuccess:()=>{t.invalidateQueries({queryKey:["gizmo","userActionSettings",{gizmoId:a}]})}})}function Ze(a){const t=R();return N({mutationFn:async({pluginId:s})=>{await ne.deletePluginUserSettings({pluginId:s})},onSuccess:()=>{t.invalidateQueries({queryKey:["gizmo","userActionSettings",{gizmoId:a}]})}})}const ea=({gizmo:a})=>{const{data:t,isLoading:s}=ve(a.gizmo.id,!0),n=D(f.GPTPrivacySettings),r=()=>x.closeModal(f.GPTPrivacySettings),j=E(),[d,l]=C.useState("actions"),p=t!=null&&t.settings.some(c=>c.oauth_status!=null&&a.tools.some(u=>u.type===M.JIT_PLUGIN&&u.metadata?.action_id===c.action_id));return d==="connected_accounts"&&!p&&l("actions"),e.jsx(q,{title:j.formatMessage(v.title),isOpen:n,onClose:r,type:"success",size:"custom",className:"min-h-[50vh] max-w-3xl overflow-y-auto scroll-smooth",noPadding:!0,showCloseButton:!0,children:s?e.jsx(se,{}):e.jsxs(je,{className:"flex flex-row gap-6 p-4",orientation:"vertical",defaultValue:d,onValueChange:c=>{l(c)},children:[p&&e.jsxs(Se,{className:ie("flex min-w-[180px] max-w-[200px] flex-shrink-0 flex-col gap-2"),children:[e.jsx(O,{value:"actions",message:v.actions}),p&&e.jsx(O,{value:"connected_accounts",message:v.connectedAccounts})]}),e.jsxs("div",{className:"flex-1 text-sm",children:[d==="actions"&&e.jsxs(V,{children:[e.jsx(o,{...v.allowedActionsDesc,values:{gizmoName:a.gizmo.display.name}}),t?.settings.map((c,u)=>{const h=a.tools?.find(m=>m.type===M.JIT_PLUGIN&&m.metadata?.action_id===c.action_id);return h&&e.jsx(aa,{gizmoId:a.gizmo.id,actionSettings:c,actionTool:h},u)})]}),d==="connected_accounts"&&e.jsxs(V,{children:[e.jsx(o,{...v.connectedAccountsDesc,values:{gizmoName:a.gizmo.display.name}}),e.jsx("div",{children:t?.settings.map((c,u)=>{const h=a.tools?.find(m=>m.type===M.JIT_PLUGIN&&m.metadata?.action_id===c.action_id);return h&&c.oauth_status&&e.jsx(ta,{gizmoId:a.gizmo.id,actionSettings:c,actionTool:h},u)})})]})]})]})})};function O({value:a,message:t}){return e.jsx(we,{className:"flex rounded-md px-2 py-1.5 text-sm text-token-text-primary radix-state-active:bg-white dark:radix-state-active:bg-token-main-surface-tertiary md:radix-state-active:bg-token-main-surface-tertiary md:radix-state-active:text-token-text-primary",value:a,children:e.jsx("div",{className:"truncate",children:e.jsx(o,{...t})})})}function aa({gizmoId:a,actionSettings:t,actionTool:s}){const n=Ye(a),r=t.action_settings?.all,j=d=>{s.metadata?.action_id&&s.metadata?.domain&&n.mutateAsync({actionId:s.metadata.action_id,domain:s.metadata.domain,settings:{all:d}})};return e.jsx("div",{children:e.jsxs(ee,{className:"border-b border-black/10 dark:border-white/10",children:[e.jsxs("div",{className:"flex flex-row space-x-4",children:[e.jsx("div",{className:"font-semibold",children:s.metadata?.domain}),e.jsxs("a",{href:s.metadata?.privacy_policy_url,target:"_blank",rel:"noreferrer",className:"flex items-center gap-1 text-token-text-tertiary hover:cursor-pointer hover:text-token-text-secondary",children:[e.jsx(o,{...v.privacyPolicyLink}),e.jsx(ye,{className:"icon-md"})]})]}),e.jsxs("select",{value:r?"always_allow":"unset",onChange:d=>j(d.target.value),className:"rounded border-none bg-token-main-surface-primary text-sm",children:[e.jsx("option",{value:"always_allow",children:e.jsx(o,{...v.alwaysAllowDropdown})}),e.jsx("option",{value:"unset",children:e.jsx(o,{...v.askDropdown})})]})]})})}function ta({gizmoId:a,actionSettings:t,actionTool:s}){const n=Ze(a),r=t.oauth_status==="valid";return e.jsxs(ee,{children:[e.jsx("div",{className:"font-semibold",children:s?.metadata?.domain}),e.jsx($,{color:"secondary",size:"small",onClick:()=>{s.metadata?.action_id&&s.metadata?.domain&&(r?n.mutateAsync({pluginId:s.metadata?.action_id}):k.doOAuthRedirect(a,s.metadata?.action_id,s.metadata?.domain,window.location.href))},children:e.jsx(o,{...r?v.logout:v.login})})]})}const V=J.div`flex flex-col gap-6`,ee=J.div`flex flex-row justify-between py-3 items-center`,v=_({title:{defaultMessage:"GPT's privacy settings",id:"GizmoPrivacySettings.title"},actions:{defaultMessage:"Actions",id:"GizmoPrivacySettings.actions"},connectedAccounts:{defaultMessage:"Connected accounts",id:"GizmoPrivacySettings.connectedAccounts"},connectedAccountsDesc:{defaultMessage:"Manage which 3rd party accounts can be accessed by {gizmoName}.",id:"GizmoPrivacySettings.connectedAccountsDesc"},allowedActionsTitle:{defaultMessage:"GPT's privacy settings",id:"GizmoPrivacySettings.allowedActionsTitle"},allowedActionsDesc:{defaultMessage:"Select which 3rd party actions are allowed in conversations with {gizmoName}.",id:"GizmoPrivacySettings.allowedActionsDesc"},privacyPolicyLink:{defaultMessage:"Privacy policy",id:"GizmoPrivacySettings.privacyPolicyLink"},alwaysAllowDropdown:{defaultMessage:"Always allow",id:"GizmoPrivacySettings.alwaysAllowDropdown"},askDropdown:{defaultMessage:"Ask",id:"GizmoPrivacySettings.askDropdown"},login:{defaultMessage:"Log in",id:"GizmoPrivacySettings.login"},logout:{defaultMessage:"Log out",id:"GizmoPrivacySettings.logout"}}),sa=a=>C.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...a},C.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.2929 2.29289C16.6834 1.90237 17.3166 1.90237 17.7071 2.29289L20.7071 5.29289C21.0976 5.68342 21.0976 6.31658 20.7071 6.70711L17.7071 9.70711C17.3166 10.0976 16.6834 10.0976 16.2929 9.70711C15.9024 9.31658 15.9024 8.68342 16.2929 8.29289L17.5858 7H10.5C7.46243 7 5 9.46243 5 12.5C5 15.5376 7.46243 18 10.5 18H15C15.5523 18 16 18.4477 16 19C16 19.5523 15.5523 20 15 20H10.5C6.35786 20 3 16.6421 3 12.5C3 8.35786 6.35786 5 10.5 5H17.5858L16.2929 3.70711C15.9024 3.31658 15.9024 2.68342 16.2929 2.29289Z",fill:"currentColor"})),ia=oe(()=>re(()=>import("./flfltvryunm0il4c.js"),__vite__mapDeps([0,1,2,3,4,5])).then(a=>a.GizmoKeepInSidebarMenuItem));function wa({children:a,clientThreadId:t,gizmoResource:s,showReportModal:n,inMobileHeader:r}){return e.jsxs(e.Fragment,{children:[e.jsx(K,{contentAlign:r?"center":"start",size:"small",triggerButton:a,children:e.jsx(oa,{clientThreadId:t,gizmoResource:s,showReportModal:n})}),e.jsx(na,{gizmoResource:s})]})}function na({gizmoResource:a}){const t=D(f.GPTRemoveThirdParty),s=le(),n=X(a);return e.jsxs(e.Fragment,{children:[e.jsx(We,{gizmoId:a.gizmo.id,creatorId:a.gizmo.author.user_id}),e.jsx(ea,{gizmo:a}),n&&e.jsx(Xe,{gizmo:a}),n&&e.jsx(be,{gizmo:a}),e.jsx(qe,{gpt:a,isOpen:t,onClose:()=>x.closeModal(f.GPTRemoveThirdParty),account:s})]})}function oa({clientThreadId:a,gizmoResource:t,showReportModal:s}){const n=Ge(t),r=Ce(t),j=Ie(t.gizmo.id),d=W(),l=ze(t),p=t.gizmo.share_recipient===U.Marketplace||t.gizmo.share_recipient===U.Link,c=!l&&p,u=L("1825130190").value,h=L("3645668434").value,m=u&&!l&&X(t),S=d?.includes(F.GizmoSupportEmails)&&!l&&t.gizmo.author.will_receive_support_emails&&m,P=de(),y=ce(a),b=Y(F.WorkspaceShareLinks),{isUnauthenticated:w}=Q(),ae=b&&y&&!w,G=xe();return e.jsxs(e.Fragment,{children:[e.jsx(i.Item,{onClick:()=>{me.logNewChatButtonClicked({location:"Gizmo information dropdown",gizmo_id:t.gizmo.id}),Me(G,`/g/${t.gizmo.short_url}`)},icon:ke,children:e.jsx(o,{...g.newChat})}),e.jsx(i.Item,{onClick:()=>x.openModal(f.GPTDetails),icon:Pe,children:e.jsx(o,{...g.about})}),t.tools?.find(I=>I.type===M.JIT_PLUGIN)&&e.jsx(i.Item,{onClick:()=>x.openModal(f.GPTPrivacySettings),icon:Te,children:e.jsx(o,{...g.privacySettings})}),n&&e.jsx(i.Item,{onClick:()=>{G(j)},icon:Ae,children:e.jsx(o,{...g.customize})}),!n&&r&&h&&e.jsxs(e.Fragment,{children:[e.jsx(i.Item,{onClick:async()=>{G(`/g/${t.gizmo.id}/view`)},icon:Fe,children:e.jsx(o,{id:"GizmoInformation.viewGizmoLabel",defaultMessage:"View configuration"})}),e.jsx(i.Item,{onClick:async()=>{const I=await k.copyGizmo({gizmoId:t.gizmo.id});I.gizmo.id&&G(`/gpts/editor/${I.gizmo.id}`)},icon:ue,children:e.jsx(o,{id:"GizmoInformation.copyGizmoLabel",defaultMessage:"Duplicate GPT"})})]}),e.jsx(ia,{gizmoResource:t,location:"conversation_page"}),e.jsx(Qe,{gizmoResource:t}),S&&e.jsx(i.Item,{onClick:()=>x.openModal(f.GPTFeedbackEmail),icon:_e,children:e.jsx(o,{...g.feedbackEmail})}),m&&e.jsx(i.Item,{onClick:()=>x.openModal(f.GPTReview),icon:Je,children:e.jsx(o,{...g.reviewGPT})}),c&&e.jsx(i.Item,{onClick:s,icon:Ee,children:e.jsx(o,{...g.report})}),ae&&e.jsx(i.Item,{onClick:()=>x.openSharingModal(y),icon:Z,children:e.jsx(o,{...g.shareChat})}),P&&e.jsxs(e.Fragment,{children:[e.jsx(i.Separator,{}),e.jsx(i.Item,{color:"danger",onClick:()=>x.openModal(f.GPTRemoveThirdParty),icon:ge,children:e.jsx(o,{defaultMessage:"Remove GPT from workspace",id:"GizmoInformation.removeGPT"})})]}),d?.includes("debug")&&e.jsxs(e.Fragment,{children:[e.jsx(i.Separator,{}),e.jsx(i.Item,{onClick:()=>{G(Ne(t))},children:"(Internal) See share page"})]})]})}const ra=({conversation:a,inMainScreen:t=!1})=>{const s=a.id,n=a.gizmo_id,r=De(n),d=W()?.includes("debug"),l=he(s),p=Y(F.WorkspaceShareLinks),{isUnauthenticated:c}=Q(),u=p&&l&&!c&&!r,h=Le(),m=E();let S=null;const{snorlaxes:P}=Ue();S=P;let y=null;r&&S&&(y=S.find(({gizmo:w})=>w.gizmo.id===n)?.gizmo);const b=Be();return e.jsxs(e.Fragment,{children:[u&&e.jsx(i.Item,{onClick:()=>x.openSharingModal(l,"History Item Menu"),icon:Z,"data-testid":"share-chat-menu-item",children:e.jsx(o,{...g.shareChat})}),null,h&&S&&S?.length>0&&He(n)&&l&&e.jsxs(e.Fragment,{children:[u&&e.jsx(i.Separator,{}),r&&e.jsxs(e.Fragment,{children:[S.length>1&&e.jsxs(i.Sub,{children:[e.jsx(i.SubMenuTrigger,{icon:B,children:e.jsx(o,{...T.moveConversationToSnorlax})}),e.jsx(i.Portal,{children:e.jsx(i.SubContent,{children:e.jsx(H,{inSidebarFlyout:!1,onUpdateConversationGizmo:w=>{b({newGizmoId:w,conversation:a,previousGizmoId:n})},currentGizmoId:n})})})]}),e.jsx(i.Item,{onClick:()=>{b({newGizmoId:null,conversation:a,previousGizmoId:n})},icon:sa,children:e.jsx("div",{className:"overflow-hidden text-ellipsis whitespace-nowrap",children:e.jsx(o,{...T.removeConversationFromSnorlax,values:{projectName:y?.gizmo.display.name??"project"}})})})]}),!r&&e.jsxs(i.Sub,{children:[e.jsx(i.SubMenuTrigger,{icon:B,children:m.formatMessage(T.addConversationToSnorlax)}),e.jsx(i.Portal,{children:e.jsx(i.SubContent,{children:e.jsx(H,{inSidebarFlyout:!1,onUpdateConversationGizmo:w=>b({newGizmoId:w,conversation:a,previousGizmoId:n})})})})]}),e.jsx(i.Separator,{})]}),e.jsx(i.Item,{disabled:!l,onClick:()=>{setTimeout(()=>{l&&A.publish({kind:t?"editTitleInMainScreen":"editTitle",serverThreadId:l})},100)},icon:Oe,children:e.jsx(o,{...g.renameChat})}),e.jsx(i.Item,{disabled:!l,onClick:()=>{l&&A.publish({kind:"archiveChat",serverThreadId:l})},icon:$e,children:e.jsx(o,{...g.archiveChat})}),e.jsx(i.Item,{color:"danger",disabled:!l,onClick:()=>{l&&A.publish({kind:"deleteChat",serverThreadId:l})},icon:Ve,"data-testid":"delete-chat-menu-item",children:e.jsx(o,{...g.deleteChat})}),d&&e.jsxs(e.Fragment,{children:[e.jsx(i.Separator,{}),e.jsx(i.Item,{onClick:()=>x.toggleActiveSidebar("debug"),icon:Ke,children:e.jsx(o,{...g.debugChat})})]})]})},ya=({conversation:a,children:t,onOpenChange:s,inMainScreen:n=!1,...r})=>e.jsx(K,{...r,onOpenChange:s,side:"bottom",contentAlign:"start",triggerButton:t,size:"auto",children:e.jsx(ra,{conversation:a,inMainScreen:n})}),g=_({newChat:{defaultMessage:"New chat",id:"GizmoInformation.newChat"},about:{defaultMessage:"About",id:"GizmoInformation.about"},privacySettings:{defaultMessage:"Privacy settings",id:"GizmoInformation.privacySettings"},viewDetails:{defaultMessage:"View details",id:"GizmoInformation.viewDetails"},share:{defaultMessage:"Share",id:"GizmoInformation.share"},favorite:{defaultMessage:"Favorite",id:"GizmoInformation.favorite"},customize:{defaultMessage:"Edit GPT",id:"GizmoInformation.customize"},feedbackEmail:{defaultMessage:"Send feedback",id:"GizmoInformation.feedbackEmail"},reviewGPT:{defaultMessage:"Review GPT",id:"GizmoInformation.reviewGPT"},report:{defaultMessage:"Report",id:"GizmoInformation.report"},privacy:{defaultMessage:"Privacy",id:"GizmoInformation.privacy"},deleteChat:{defaultMessage:"Delete",id:"GizmoInformation.deleteChat.0"},debugChat:{defaultMessage:"(Internal) Debug",id:"GizmoInformation.debugChat"},renameChat:{defaultMessage:"Rename",id:"GizmoInformation.renameChat"},archiveChat:{defaultMessage:"Archive",id:"GizmoInformation.archiveChat.0"},shareChat:{defaultMessage:"Share",id:"GizmoInformation.shareChat"},shareChatLong:{defaultMessage:"Share chat",id:"GizmoInformation.shareChatLong"}});export{ya as GizmoConversationOptionsDropdown,wa as GizmoInformationDropdown,oa as GizmoInformationDropdownItems};
//# sourceMappingURL=j492ff3c1rtrw6ax.js.map
