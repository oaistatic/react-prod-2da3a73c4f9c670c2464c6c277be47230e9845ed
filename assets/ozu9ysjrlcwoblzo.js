import{c as L,r as o,j as e,ax as U,av as S,M as r}from"./izh0i1dfnf8ev7x1.js";import{q as z,r as D,d as $,U as q,H as R,by as H}from"./fc2hzad6rtrm7s5f.js";import{S as J,P as K,a as V,b$ as X,bh as Y,bY as Z,br as O}from"./hggowi1ggrzb09yc.js";const Q=5,W="Default";function ee(n){const i={};return n.forEach(d=>{const l=d.group??W;i[l]||(i[l]=[]),i[l].push(d)}),i}function ne({tagOptions:n,onSubmit:i,onMoreClicked:d,onCancel:l,maxInlineTags:E=Q,modalOnly:u=!1,modalTitle:P,multiple:_,children:A,allowEmptySubmit:w=!1}){const v=L(),[m,c]=o.useState(u?"modal":"inline"),[a,j]=o.useState([]),[b,B]=o.useState(void 0),{eligible:x,markAsViewed:T}=z(D.hasSeenInlineFeedbackCustomInstrMessage),y=x?4e3:1500,[g,G]=o.useState(!1),f=o.useCallback(s=>{i(s),c("submitted");const t=["Too chatty or casual","Don't like the style"];G(s.tags.some(h=>t.includes(h))),setTimeout(()=>{c("closed"),x&&g&&T()},y)},[i,y,x,T,g]),p=o.useMemo(()=>$(f,500),[f]),M=s=>{let t=[];return _?t=a.includes(s)?a.filter(h=>h!==s):[...a,s]:t=[s],j(t),t},C=()=>{f({tags:a,textFeedback:b,tagChoices:N,source:"modal"})},N=n.map(s=>s.value),I=ee(n),F=Object.keys(I);return e.jsxs(e.Fragment,{children:[!u&&e.jsx(U,{children:m!=="closed"&&e.jsxs(S.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"min-h-[96px] w-full",children:[m==="submitted"&&e.jsx(S.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"text-center",children:e.jsx("div",{className:"inline-flex rounded-lg border border-token-border-light p-4",children:e.jsx("div",{className:"text-sm",children:x&&g?e.jsx(e.Fragment,{children:e.jsx(r,{id:"ConversationTurnInlineMessageFeedback.customInstructions",defaultMessage:"Thanks! If ChatGPT's style isn't quite right, you can also <link>customize its responses</link>.",values:{link:s=>e.jsx("span",{onClick:()=>{q.openModal(R.UserContext),J.logEvent("chatgpt_user_context_inline_feedback_message_clicked"),K.logEvent(V.userContextInlineFeedbackMessageClicked)},className:"cursor-pointer font-semibold text-token-text-primary",children:s})}})}):e.jsx(r,{id:"ConversationTurnInlineMessageFeedback.submitted",defaultMessage:"Thanks for your feedback!"})})})}),["inline","modal"].includes(m)&&e.jsxs("div",{className:"relative mt-2 flex w-full flex-col gap-3 rounded-lg border border-token-border-light p-4",children:[e.jsx("button",{className:"absolute right-4 top-4 text-sm font-bold",onClick:()=>{c("closed"),p.cancel(),l?.()},children:e.jsx(X,{className:"icon-md text-token-text-secondary hover:text-token-text-primary"})}),e.jsx("div",{className:"text-sm text-token-text-secondary",children:e.jsx(r,{id:"ConversationTurnInlineMessageFeedback.inlineTitle",defaultMessage:"Tell us more:"})}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[n.slice(0,E).map(s=>e.jsx(k,{"aria-pressed":a.includes(s.value),"aria-selected":a.includes(s.value),$selected:a.includes(s.value),onClick:()=>{const t=M(s.value);p({tags:t,tagChoices:N,source:"inline"})},children:s.label},s.value)),e.jsx(k,{onClick:()=>{d?.(),p.cancel(),c("modal")},children:e.jsx(r,{id:"ConversationTurnInlineMessageFeedback.moreOptions.1",defaultMessage:"More..."})})]})]})]},"main")}),m==="modal"&&e.jsxs(Y,{type:"success",isOpen:!0,className:"max-w-xl",size:"custom",title:P??e.jsx(r,{id:"ConversationTurnInlineMessageFeedback.modalTitle",defaultMessage:"Provide additional feedback"}),onClose:()=>{j([]),c(u?"closed":"inline"),u&&l?.()},showCloseButton:!0,primaryButton:e.jsx(Z,{color:"primary",disabled:a.length===0&&!b&&!w,onClick:C,children:e.jsx(r,{id:"ConversationTurnInlineMessageFeedback.submit",defaultMessage:"Submit"})}),rootClassName:"z-50",children:[e.jsx("div",{className:"flex flex-col gap-6",children:F.map(s=>e.jsxs("div",{children:[F.length>1&&e.jsx("div",{className:"mb-3 text-sm font-semibold",children:s}),e.jsx("div",{className:"flex flex-wrap gap-3",children:I[s].map(t=>e.jsx(k,{$selected:a.includes(t.value),onClick:()=>M(t.value),children:t.label},t.value))},s)]},s))}),e.jsx(H,{ariaLabel:v.formatMessage({id:"Z3Ja/T",defaultMessage:"Additional feedback"}),name:"feedback",type:"text",className:"mt-6",placeholder:v.formatMessage({id:"ConversationTurnInlineMessageFeedback.feedbackPlaceholder.1",defaultMessage:"(Optional) Feel free to add specific details"}),value:b??"",onChange:s=>B(s.target.value),onPressEnter:C}),A]})]})}const k=O.button`
  rounded-lg border border-token-border-light px-3 py-1 text-sm text-token-text-secondary hover:text-token-text-primary hover:bg-token-main-surface-secondary
  ${({$selected:n})=>n&&"!bg-token-text-primary !text-token-main-surface-primary"}
`;export{ne as I,k as T};
//# sourceMappingURL=ozu9ysjrlcwoblzo.js.map
