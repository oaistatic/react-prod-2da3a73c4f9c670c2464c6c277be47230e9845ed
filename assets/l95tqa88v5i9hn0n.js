const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/mxgyctooduncz3iz.js","assets/hggowi1ggrzb09yc.js","assets/izh0i1dfnf8ev7x1.js","assets/root-ko7rpr3h.css","assets/dxpde14qu5zfq5m7.js","assets/fc2hzad6rtrm7s5f.js","assets/conversation-small-lgvqkxxm.css","assets/e39bu4t80vijswin.js","assets/l2i0py62vkyv61za.js","assets/m9e86ummh8a7fx0f.js","assets/f9bblkkpmnem4qu7.js","assets/l3v68ds865zwh57s.js","assets/pcacsxfe3uxv1gro.js","assets/ki2fnq5gqslif1ka.js","assets/ce16o59eqx0v8uku.js","assets/flhi48dysn4unlgl.js","assets/dzs9jsp7hkzpbuhr.js"])))=>i.map(i=>d[i]);
import{br as I,V as le,n as P,cA as _e,M as X,E as ce,cc as de,bY as B,s as D,r as ue,d as me,o as ge,aL as Ne,d2 as ke,cs as Me,bv as pe,bw as xe,al as fe,H as G,bh as W,h as De,gI as y,b_ as F,gJ as Oe,Q as Pe,eL as he}from"./hggowi1ggrzb09yc.js";import{j as e,r as d,c as be,M as Le,a as ve}from"./izh0i1dfnf8ev7x1.js";import{iS as K,iT as v,iU as Y,iV as Z,d as Re,K as N,gP as Te,r as Ae,U as Ie,dH as Ve,dI as Fe,dJ as ee,dL as te,Q as Ee,gB as $e,dK as Ue,iW as Be,iX as qe,iY as Je}from"./fc2hzad6rtrm7s5f.js";import{S as je}from"./ki2fnq5gqslif1ka.js";import{S as $,c as ye,_ as We,a as ae,b as H,v as He,d as se,g as ze,e as Ge,u as Ke,f as Qe}from"./kaeuu7lrrhyntd9q.js";import{A as Se}from"./ei7ej0cmjdt2qsbq.js";import{_ as Xe}from"./fzrn137102spawew.js";import{C as Ye}from"./dxpde14qu5zfq5m7.js";import"./e9lafxuzyeh4418f.js";import"./d7bvxndom3b3tpj8.js";function Ze(){const t=K();return e.jsx(e.Fragment,{children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between",children:["Force Use Search",!1]}),e.jsx($,{id:"force-use-search",options:[{label:"Default",value:"default"},{label:"Force",value:"true"},{label:"Disable",value:"false"}],name:"force-use-search",className:"mt-1 shadow-none dark:text-gray-800",value:t.forceUseSearch==null?{value:"default",label:"Default"}:t.forceUseSearch?{value:"true",label:"Force"}:{value:"false",label:"Disable"},isMulti:!1,components:{Input:et},onChange:a=>{v({forceUseSearch:(a?.value??"default")==="default"?null:a?.value==="true"})}})]})})}const et=t=>e.jsx(ye.Input,{...t,inputClassName:"focus:ring-0"});var tt=["allowCreateWhileLoading","createOptionPosition","formatCreateLabel","isValidNewOption","getNewOptionData","onCreateOption","options","onChange"],ne=function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",o=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,l=String(a).toLowerCase(),s=String(n.getOptionValue(o)).toLowerCase(),i=String(n.getOptionLabel(o)).toLowerCase();return s===l||i===l},z={formatCreateLabel:function(a){return'Create "'.concat(a,'"')},isValidNewOption:function(a,o,n,l){return!(!a||o.some(function(s){return ne(a,s,l)})||n.some(function(s){return ne(a,s,l)}))},getNewOptionData:function(a,o){return{label:o,value:a,__isNew__:!0}}};function at(t){var a=t.allowCreateWhileLoading,o=a===void 0?!1:a,n=t.createOptionPosition,l=n===void 0?"last":n,s=t.formatCreateLabel,i=s===void 0?z.formatCreateLabel:s,r=t.isValidNewOption,c=r===void 0?z.isValidNewOption:r,u=t.getNewOptionData,p=u===void 0?z.getNewOptionData:u,h=t.onCreateOption,b=t.options,m=b===void 0?[]:b,x=t.onChange,f=We(t,tt),C=f.getOptionValue,j=C===void 0?ze:C,g=f.getOptionLabel,L=g===void 0?Ge:g,S=f.inputValue,A=f.isLoading,R=f.isMulti,O=f.value,T=f.name,w=d.useMemo(function(){return c(S,ae(O),m,{getOptionValue:j,getOptionLabel:L})?p(S,i(S)):void 0},[i,p,L,j,S,c,m,O]),V=d.useMemo(function(){return(o||!A)&&w?l==="first"?[w].concat(H(m)):[].concat(H(m),[w]):m},[o,l,A,w,m]),q=d.useCallback(function(k,_){if(_.action!=="select-option")return x(k,_);var M=Array.isArray(k)?k:[k];if(M[M.length-1]===w){if(h)h(S);else{var J=p(S,S),we={action:"create-option",name:T,option:J};x(He(R,[].concat(H(ae(O)),[J]),J),we)}return}x(k,_)},[p,S,R,T,w,h,x,O]);return se(se({},f),{},{options:V,onChange:q})}var st=d.forwardRef(function(t,a){var o=Ke(t),n=at(o);return d.createElement(Qe,Xe({ref:a},n))}),nt=st;function rt({children:t,sidebarOpen:a,onClose:o}){return e.jsx(Y.Root,{show:a,as:d.Fragment,children:e.jsxs(Z,{as:"div",className:"relative z-10",onClose:o,children:[e.jsx("div",{className:"fixed inset-0"}),e.jsx("div",{className:"fixed inset-0 overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 overflow-hidden",children:e.jsx("div",{className:"pointer-events-none fixed inset-y-0 right-0 flex max-w-full pl-10",children:e.jsx(Y.Child,{as:d.Fragment,enter:"transform transition ease-in-out duration-100 sm:duration-300",enterFrom:"translate-x-full",enterTo:"translate-x-0",leave:"transform transition ease-in-out duration-300 sm:duration-500",leaveFrom:"translate-x-0",leaveTo:"translate-x-full",children:e.jsx(Z.Panel,{className:"pointer-events-auto w-screen max-w-md border-l border-gray-100 dark:border-gray-700",children:e.jsx("div",{className:"h-full overflow-y-auto bg-token-main-surface-primary shadow-xl",children:t})})})})})})]})})}function ot({clientThreadId:t}){const{rebaseSystemMessageContent:a,showDebugConversationTurns:o}=K(),[n,l]=d.useState(()=>a?JSON.stringify(a,null,2):void 0),[s,i]=d.useState(!!a),r=le(t,D.getBranch).filter(m=>m.message.author.role!==P.Root).map(m=>m.message),u=_e(r,m=>m.content.content_type===X.SystemContent)?.content??null,p=()=>{l(u?JSON.stringify(u,null,2):"")},h=ce(),b=d.useMemo(()=>Re(m=>{try{m?v({rebaseSystemMessageContent:{...JSON.parse(m),content_type:X.SystemContent}}):v({rebaseSystemMessageContent:null}),h.closeAll()}catch{h.danger("The System Message is not valid JSON")}},500),[h]);return d.useEffect(()=>{s?b(n):(b.cancel(),v({rebaseSystemMessageContent:null}))},[b,s,n]),e.jsxs("div",{className:"flex flex-col gap-3 px-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(de,{label:"Enable to apply this system message to the current conversation.",children:e.jsx(N,{id:"enabled",label:"Enabled",checked:s,onChange:m=>i(m.currentTarget.checked)})}),e.jsx(N,{id:"show-internal-conversation-turns",label:"Conversation debug mode",checked:o,onChange:()=>{v({showDebugConversationTurns:!o})}})]}),e.jsx(B,{disabled:!u,className:"mt-2",onClick:p,size:"small",children:"Load active system message"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm",children:"System Message"}),e.jsx(it,{disabled:!s,placeholder:u?"Press `Load active system message` to pre-populate this":"Start a conversation and then press `Load active system message` to pre-populate this",className:"min-h-[75vh] rounded-md border border-gray-400 p-1 font-mono",value:n,onChange:m=>l(m.target.value)})]})]})}const it=I.textarea`w-full rounded-lg border border-token-border-light bg-token-main-surface-primary text-sm text-token-text-primary focus:border-token-text-primary focus:shadow-none focus:outline-none focus:ring-token-text-primary disabled:bg-token-main-surface-tertiary`;function lt({clientThreadId:t}){const[a,o]=d.useState([]),n=ue(t),l=D.getCurrentLeafId(n),s=D.getConversationTurns(n),i=c=>{Ne(t,u=>{const p=D.getTree(u).getLeafFromNode(c);ke.setCurrentLeafId(u,p.id)})},r=c=>{o(u=>[...u,l]),i(c)};return e.jsxs(e.Fragment,{children:[a.length>0&&e.jsxs(B,{className:"absolute left-2 top-2",color:"secondary",onClick:()=>{const c=a[a.length-1];i(c),o(u=>u.slice(0,-1))},children:[e.jsx(Te,{className:"icon-sm"}),"Go back to ",a[a.length-1]]}),e.jsx("div",{className:"flex flex-col items-center gap-4 overflow-auto p-4 text-xs",children:s.map((c,u)=>{const p=c.messages[0].nodeId,h=D.getTree(n),b=u!==0?h.getParent(p):null,m=b!=null?b.children.findIndex(g=>p===g):0,x=b!=null?b.children:[],f=x.slice(0,m),C=x.slice(m+1);let j;switch(c.role){case P.User:j="bg-blue-500";break;case P.Assistant:j="bg-gray-600";break;default:j="bg-gray-400";break}return e.jsxs("div",{className:me("relative p-2",j),children:[e.jsx("div",{className:"absolute bottom-0 left-0 -ml-2 flex -translate-x-full gap-2 pl-2",children:f.map(g=>e.jsx(re,{variantId:g,onChangeItemInView:r},g))}),e.jsx("div",{className:"absolute left-full top-0 ml-2 flex gap-2 pr-2",children:C.map(g=>e.jsx(re,{variantId:g,onChangeItemInView:r},g))}),e.jsx("div",{className:"flex flex-col gap-2",children:c.messages.map(g=>e.jsxs("div",{className:"h-14 w-32 truncate bg-gray-200 p-1 text-black",children:[e.jsx("div",{className:"font-semibold",children:g.nodeId}),e.jsx("div",{className:"italic text-token-text-tertiary",children:g.message.author.role}),e.jsx("div",{children:ge(g.message)})]},g.nodeId))})]},u)})})]})}function re({variantId:t,onChangeItemInView:a}){return e.jsx("button",{className:"w-32 truncate bg-gray-400 p-2 text-black opacity-50 hover:opacity-100",onClick:()=>{a(t)},children:e.jsx("span",{className:"bg-gray-200 p-2",children:t})},t)}const ct=pe(()=>xe(()=>import("./mxgyctooduncz3iz.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14])).then(t=>t.DebugModalContents)),dt=pe(()=>xe(()=>import("./flhi48dysn4unlgl.js"),__vite__mapDeps([15,2,1,3,16,5,6])).then(t=>t.FramesViewer)),oe=Object.values(Ae);function Lt(){return e.jsx("button",{"data-testid":"open-debug-sidebar-button",className:"flex h-6 w-6 items-center justify-center rounded-full border border-token-border-light text-xs text-token-text-secondary",onClick:()=>{Ie.setActiveSidebar("debug")},children:e.jsx(je,{className:"icon-xs"})})}function ut({children:t,title:a,icon:o,isOpen:n,slideOver:l,onClose:s}){const i=e.jsxs(vt,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 text-lg font-semibold text-gray-900 dark:text-white",children:[e.jsx(o,{className:"icon-sm"}),a]}),e.jsx("div",{className:"mr-2 mt-2 flex h-7 items-center",children:e.jsx(Me,{onClick:s})})]}),t]});return l?e.jsx(rt,{sidebarOpen:n,onClose:s,children:i}):n?i:null}function mt({nodes:t,setDebugNodeIndex:a,setFrameSrc:o,conversationId:n}){const l=t.map((s,i)=>{const r=s.message,{role:c,name:u}=r.author,p=u&&u!==c,h=y(r,"metadata.__internal.model_id"),b=y(r,"metadata.__internal.s2s_vm_id"),m=y(r,"metadata.__internal.agent.settings.completion_api.engine"),x=b??m,f=y(r,"metadata.__internal.model_experiment_name"),C=y(r,"metadata.__internal.model_experiment_treatment"),j=y(r,"metadata.__internal.alternative_model_selection_rule"),g=y(r,"metadata.__internal.model_experiment_group_name"),L=y(r,"metadata.__internal.model_experiment_group_params"),S=y(r,"metadata.__internal.model_experiment_override"),A=y(r,"metadata.__internal.model_experiment_eval_seq"),R=y(r,"metadata.__internal.raw_tokens")?.length,O=y(r,"metadata.request_id"),T=y(r,"metadata.__internal.search_settings"),w=F.getAudio(r),V=F.getAudioAssetPointers(r),q=F.getFrameAssetPointers(r),k=F.getVideoContainerAssetPointers(r);return e.jsxs(yt,{role:"button",onClick:()=>a(i),children:[e.jsxs("div",{className:me("flex items-center gap-1 break-words text-xs font-semibold uppercase",c===P.User?"text-token-text-primary":"text-token-text-tertiary"),children:[c===P.User&&e.jsx(Be,{className:"icon-sm"}),c,p&&` (${u})`,r.recipient&&" -> ",Oe(r)]}),(r.author.role!==P.System||O)&&e.jsxs("div",{className:"text-xs text-token-text-tertiary",children:[e.jsxs("div",{children:["ID: ",r.id]}),s.id!==r.id&&e.jsxs("div",{children:["UI Node ID: ",s.id]}),e.jsxs("div",{children:["Req ID: ",O||"Reload page to see ID"]})]}),e.jsx("div",{className:"line-clamp-6",children:ge(r)}),(R||h||x||f||C||j||g||L||S||A||T)&&e.jsxs("div",{className:"mt-4 w-full self-start rounded-xl bg-blue-200 px-3 py-0.5 text-xs text-black",children:[R!==void 0&&e.jsxs("div",{children:[e.jsx("b",{children:"Tokens Count:"})," ",R]}),h&&e.jsxs("div",{children:[e.jsx("b",{children:"Model ID:"})," ",h]}),x&&e.jsxs("div",{children:[e.jsx("b",{children:"Engine:"})," ",x]}),f&&e.jsxs("div",{children:[e.jsx("b",{children:"Experiment:"})," ",f]}),C&&e.jsxs("div",{children:[e.jsx("b",{children:"Treatment:"})," ",C]}),j&&e.jsxs("div",{children:[e.jsx("b",{children:"Alternative Model Rule:"})," ",j]}),g&&e.jsxs("div",{children:[e.jsx("b",{children:"Group Name:"})," ",g]}),L&&e.jsxs("div",{children:[e.jsx("b",{children:"Group Params:"}),e.jsx("div",{children:JSON.stringify(L,null,2)})]}),S&&e.jsxs("div",{children:[e.jsx("b",{children:"Above Params are Overridden By:"})," ",S]}),A&&e.jsxs("div",{children:[e.jsx("b",{children:"Experiment Eval Seq:"})," click to see"]}),T&&e.jsxs("div",{children:[e.jsx("b",{children:"Search Settings:"}),e.jsx("div",{children:JSON.stringify(T,null,2)})]})]}),w.length||V.length||k.length?e.jsxs("div",{className:"mt-4 flex flex-col flex-nowrap gap-2",children:[e.jsx(ht,{frameAssets:q,setFrameSrc:o},i),w.map((_,M)=>e.jsx(U,{audio:_,conversationId:n},`audio-asset-${M}`)),V.map((_,M)=>e.jsx(U,{assetPointer:_,conversationId:n},`audio-${M}`)),k.map((_,M)=>e.jsx(bt,{assetPointer:_,conversationId:n},`video-asset-${M}`))]}):null]},r.id)});return e.jsx(jt,{children:l})}const E=t=>e.jsx(ye.Input,{...t,inputClassName:"focus:ring-0"});function gt(){const t=K(),o=qe().map(s=>({label:s.name,options:s.options.flatMap(i=>"options"in i?i.options.map(r=>({label:r.value,value:r.value})):[{label:`${i.value} (${i.name})`,value:i.value}])})),[n,l]=d.useState(oe[0]);return e.jsxs("div",{className:"mt-2 flex flex-col justify-around gap-3 px-4 py-1 text-xs font-semibold",children:[e.jsx(N,{id:"force-paragen",label:"Force Parallel Gen",checked:t.forceParagen,onChange:()=>{v({forceParagen:!t.forceParagen})}}),e.jsx(nt,{options:o,name:"force-paragen-model",className:"shadow-none dark:text-gray-800",isDisabled:!t.forceParagen,isLoading:o.length===0,value:t.forceParagenModel,isClearable:!0,isMulti:!1,components:{Input:E},onChange:s=>{v({forceParagenModel:s??Je})}}),t.forceParagen?e.jsxs(e.Fragment,{children:[e.jsx("div",{children:"Paragen Stream Type:"}),e.jsx($,{options:[{label:"Do Not Override",value:"none"},{label:"Force Classic Stream Behavior",value:"default"},{label:"Wait for Assistant",value:"wait_for_assistant"},{label:"Interleave",value:"interleave"}],name:"paragen-stream-type",className:"shadow-none dark:text-gray-800",value:t.paragenStreamType==="none"?{value:"none",label:"Do Not Override"}:t.paragenStreamType==="default"?{value:"default",label:"Force Classic Stream Behavior"}:t.paragenStreamType==="wait_for_assistant"?{value:"wait_for_assistant",label:"Wait for Assistant"}:{value:"interleave",label:"Interleave"},isMulti:!1,components:{Input:E},onChange:s=>{v({paragenStreamType:s?.value??"none"})}})]}):null,t.forceParagen?e.jsxs(e.Fragment,{children:[e.jsx("div",{children:"Show CoT in Paragen:"}),e.jsx($,{options:[{label:"Allow",value:"allow"},{label:"Hide CoT for Alter Model",value:"hide_alter"},{label:"Hide",value:"hide"}],name:"paragen-stream-type",className:"shadow-none dark:text-gray-800",value:t.paragenCotSummaryDisplay==="allow"?{value:"allow",label:"Allow"}:t.paragenCotSummaryDisplay==="hide_alter"?{value:"hide_alter",label:"Hide CoT for Alter Model"}:{value:"hide",label:"Hide"},isMulti:!1,components:{Input:E},onChange:s=>{v({paragenCotSummaryDisplay:s?.value??"allow"})}})]}):null,e.jsx(N,{id:"show-paragen-metadata",label:"Show Paragen Metadata",checked:t.showParagenMetadata,onChange:()=>{v({showParagenMetadata:!t.showParagenMetadata})}}),e.jsx(Ze,{}),e.jsx(N,{id:"record-rendering",label:"Record Rendering",checked:t.recordRendering,onChange:()=>{v({recordRendering:!t.recordRendering})}}),e.jsx(N,{id:"force-rate-limit",label:"Force Rate Limit",checked:t.forceRateLimit,onChange:()=>{v({forceRateLimit:!t.forceRateLimit})}}),e.jsx(N,{id:"reset-rate-limit",label:"Reset Rate Limits",checked:t.resetRateLimits,onChange:()=>{v({resetRateLimits:!t.resetRateLimits})}}),e.jsx(de,{label:"Enabling this will show debug conversation messages in the chat",children:e.jsx(N,{id:"show-internal-conversation-turns",label:"Conversation debug mode",checked:t.showDebugConversationTurns,onChange:()=>{v({showDebugConversationTurns:!t.showDebugConversationTurns})}})}),e.jsx(N,{id:"force-show-convo-rating",label:"Force Show Conversation Rating",checked:t.forceShowConvoRating,onChange:()=>{v({forceShowConvoRating:!t.forceShowConvoRating})}}),e.jsx("hr",{}),e.jsx("div",{children:"Reset announcement:"}),e.jsx($,{options:oe.map(s=>({label:s.replace("oai/apps/",""),value:s})),name:"reset-announcement",className:"break-all font-mono shadow-none dark:text-gray-800",value:{label:n,value:n},isMulti:!1,components:{Input:E},onChange:s=>{s?.value&&l(s?.value)}}),e.jsx(B,{onClick:()=>Pe.resetAnnouncement(n),children:"Reset"})]})}const ie=I.div`px-3 pb-2 text-xs font-semibold uppercase border-b-2 ${({$isSelected:t})=>t?"border-black dark:border-white":"border-transparent"}`;function Rt({clientThreadId:t,isOpen:a,slideOver:o,onClose:n}){const l=be(),s=fe(),[i,r]=d.useState("conversation");return s?.includes("debug")?e.jsx(ut,{icon:je,title:l.formatMessage(Q.debugTitle),isOpen:a,slideOver:o,onClose:n,children:e.jsxs(Ve,{orientation:"vertical",defaultValue:i,onValueChange:c=>r(c),children:[e.jsxs(Fe,{className:"mb-4 flex items-center justify-center gap-2 px-2 py-1 text-xs",children:[e.jsx(ee,{value:"conversation",children:e.jsx(ie,{$isSelected:i==="conversation",children:"Conversation"})}),e.jsx(ee,{value:"system-message-editor",children:e.jsx(ie,{$isSelected:i==="system-message-editor",children:"System Message"})}),!1]}),e.jsx(te,{value:"conversation",children:e.jsx(pt,{clientThreadId:t})}),e.jsx(te,{value:"system-message-editor",children:e.jsx(ot,{clientThreadId:t})}),!1]})}):null}function pt({clientThreadId:t}){const a=be(),o=le(t,D.getBranch).filter(x=>x.message.author.role!==P.Root),[n,l]=d.useState(),s=fe(),i=d.useCallback(()=>{l(void 0)},[]),r=ce(),c=d.useCallback(x=>{const f=ue(t),C=D.getTree(f),j=D.getCurrentLeafId(f);Ee(C.getTextFromThread(j),r,x)},[t,r]),[u,p]=d.useState(!1),[h,b]=d.useState(void 0);return s?.includes("debug")?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-2 flex items-center justify-around px-4 py-1 text-xs font-semibold uppercase",children:e.jsx(ft,{clientThreadId:t,messages:o.map(x=>x.message)})}),!1,e.jsxs("div",{className:"flex items-center justify-around gap-2 px-4 py-1 text-xs font-semibold uppercase",children:[e.jsx("div",{children:e.jsx(Ye,{onCopy:c,buttonText:a.formatMessage(Q.copyText)})}),e.jsxs("button",{className:"flex items-center justify-center gap-2",onClick:()=>p(!0),children:[e.jsx($e,{className:"icon-sm rotate-90"}),"View tree"]})]}),e.jsx(gt,{}),null,e.jsx(mt,{nodes:o,setDebugNodeIndex:l,setFrameSrc:b,conversationId:G(t)}),n!==void 0&&e.jsx(W,{type:"success",size:"fullscreen",noPadding:!0,isOpen:!0,onClose:i,children:e.jsx(ct,{threadId:o[n].message.metadata?.__internal?.sonic_thread_id,threadUserId:o[n].message.metadata?.__internal?.sonic_user_id,onClose:i,message:o[n].message})},`DebugMessageModal-${n}`),u&&e.jsx(W,{isOpen:!0,onClose:()=>p(!1),type:"success",size:"custom",noPadding:!0,children:e.jsx(lt,{clientThreadId:t})},"DebugTreeViewer"),h&&e.jsx(W,{size:"normal",isOpen:!0,onClose:()=>b(void 0),type:"success",children:e.jsx("img",{src:h,alt:"debug image"})},"DebugFrameViewer")]}):null}function xt(t,a){const o=JSON.stringify({conversation_id:G(t),messages:a},null,2),n=new Blob([o],{type:"application/json"}),l=URL.createObjectURL(n),s=document.createElement("a");s.href=l,s.download=`messages-${G(t)}.json`,s.click(),URL.revokeObjectURL(l)}function ft({clientThreadId:t,messages:a}){const o=d.useCallback(()=>{xt(t,a)},[t,a]);return e.jsx(B,{onClick:o,color:"primary",size:"small",icon:Ue,children:e.jsx(Le,{...Q.downloadRawConversation})})}function ht(t){const[a,o]=d.useState([]),n=ve(),{frameAssets:l}=t;return d.useEffect(()=>{async function s(){const i=l.map(async({image_asset_pointer:r,timestamp:c})=>{const u={asset:r};return{src:(await Se.fetch(n,u)).url,timestamp:c}});return Promise.all(i)}l.length>0&&s().then(o)},[l,n]),e.jsx(dt,{frames:a,setFrameSrc:t.setFrameSrc})}function U(t){const a=Ce(t.assetPointer,t.conversationId),o=U.useAudioSource(t.audio),n=a??o,s=he("3230069703").config.value.expirySeconds,[i,r]=d.useState(Date.now()),c=d.useRef(null);return d.useEffect(()=>{const u=setInterval(()=>{c.current&&c.current.currentTime>0&&!c.current.paused&&!c.current.ended&&c.current.readyState>2||r(Date.now())},s*1e3);return()=>clearInterval(u)},[s]),n?e.jsx("audio",{ref:c,controls:!0,src:n,className:"w-full"},i):null}function Ce(t,a){const[o,n]=d.useState(null),l=ve();return d.useEffect(()=>{t&&Se.fetch(l,{asset:t,conversationId:a}).then(s=>{n(s.url)})},[l,t,a]),o}U.useAudioSource=t=>{const[a,o]=d.useState(null);return d.useEffect(()=>{if(t){const n=atob(t.payload),l=new Uint8Array(n.length);for(let r=0;r<n.length;r++)l[r]=n.charCodeAt(r);const s=new Blob([l],{type:`audio/${t.format}`}),i=URL.createObjectURL(s);return o(i),()=>{URL.revokeObjectURL(i)}}},[t]),a};function bt(t){const a=Ce(t.assetPointer,t.conversationId),n=he("3230069703").config.value.expirySeconds,[l,s]=d.useState(Date.now()),i=d.useRef(null);return d.useEffect(()=>{const r=setInterval(()=>{i.current&&i.current.currentTime>0&&!i.current.paused&&!i.current.ended&&i.current.readyState>2||s(Date.now())},n*1e3);return()=>clearInterval(r)},[n]),a?e.jsx("video",{ref:i,controls:!0,src:a,className:"w-full"},l):null}const vt=I.div`overflow-y-auto h-full md:w-[250px] lg:w-[300px] xl:w-[350px] 2xl:w-[400px] md:border-l md:border-gray-100 md:dark:border-gray-700 popover bg-token-main-surface-primary`,jt=I.pre`whitespace-pre-wrap text-sm`,yt=I.div`px-6 py-4 flex flex-col gap-1 hover:bg-gray-50 dark:hover:bg-gray-500/10 cursor-pointer border-b dark:border-white/10 border-gray-200`,Q=De({debugTitle:{id:"DebugSidebar.debugTitle",defaultMessage:"Debug"},copyText:{id:"DebugSidebar.copyText",defaultMessage:"Copy text"},downloadRawConversation:{id:"DebugSidebar.downloadRawConversation",defaultMessage:"Download raw conversation"},uploadRawConversation:{id:"DebugSidebar.uploadRawConversation",defaultMessage:"Upload conversation dump"},closeSidebar:{id:"DebugSidebar.closeSidebar",defaultMessage:"Close sidebar"}});export{Rt as DebugConversationSidebar,Lt as OpenDebugSidebarButton,ut as default};
//# sourceMappingURL=l95tqa88v5i9hn0n.js.map
