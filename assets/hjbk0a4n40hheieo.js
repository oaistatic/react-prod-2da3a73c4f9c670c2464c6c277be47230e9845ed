const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/a81k56656r3wjnv3.js","assets/izh0i1dfnf8ev7x1.js","assets/fc2hzad6rtrm7s5f.js","assets/hggowi1ggrzb09yc.js","assets/root-ko7rpr3h.css","assets/conversation-small-lgvqkxxm.css","assets/nmdx1tlxypc6rrhx.js","assets/d3y72ugnrmac5z1v.js","assets/kaeuu7lrrhyntd9q.js","assets/fzrn137102spawew.js","assets/e9lafxuzyeh4418f.js","assets/d7bvxndom3b3tpj8.js"])))=>i.map(i=>d[i]);
import{j as e,M as d,e as we,r as o,av as U,c as F,u as Me,d as ie,ax as K,R as O}from"./izh0i1dfnf8ev7x1.js";import{v as B,P as v,el as Ne,V as ke,s as Te,a8 as Pe,bY as A,dj as _e,dt as Ie,d as S,c6 as Ae,c8 as Ue,c9 as Fe,cb as Be,h as H,br as oe,Q as le,S as D,a as W,g_ as Ee,b$ as Le,bv as Re,bw as Oe,E as De,al as We,d1 as ze,ad as He,e3 as qe,en as Ve,ax as ce,cj as $e,J as Ge,g$ as Xe,bu as L,aA as Qe,aB as Ye,fT as Ke,ae as Je,dw as Ze,bW as G,ar as et,bt as de,c4 as tt,bX as st,bH as at,eh as b,eg as nt}from"./hggowi1ggrzb09yc.js";import{lJ as ue,hJ as me,lK as rt,i as J,bl as fe,v as Z,U as T,en as z,es as it,lL as R,lM as ot,lN as lt,lO as se,H as ge,lP as ct,lQ as dt,bw as ut,dB as he,lR as mt,lS as ae,a7 as ft,lT as gt,lU as ht,aB as xt,dD as pt,dC as jt,lV as I,bQ as xe,lW as bt,lX as ee,lY as vt,lZ as St,l_ as yt,l$ as ne,m0 as Ct,m1 as wt,m2 as Mt,B as pe,by as Nt,m3 as kt,kt as Tt,m4 as Pt,kl as _t,ku as It,m5 as At,m6 as Ut,m7 as Ft,jx as je,hX as Bt,jA as Et,jB as Lt,fm as Rt,jy as Ot,jz as Dt}from"./fc2hzad6rtrm7s5f.js";import{N as be,h as Wt,U as ve,i as zt}from"./in3ze5ugryldzaj2.js";function Ms({onClick:t,className:s,...a}){return e.jsx(Wt,{onClick:t,className:S(s,"flex-grow overflow-hidden"),...a})}function Ns({onNewChatButtonClick:t}){const{isUnauthenticated:s,isLoading:a}=B();return a||!s?null:e.jsx(be,{className:"mr-3",onClick:()=>{v.logNewChatButtonClicked({location:"Mobile header"}),t()}})}function ks({onNewChatButtonClick:t,clientThreadId:s}){const{isUnauthenticated:a,isLoading:n}=B(),i=ue(),r=Ne(s),u=me(r),l=ke(s,Te.getIsNewConversation),m=Pe(),f=l&&m&&u;if(n)return null;if(a)return i?e.jsx(qt,{}):e.jsx(Ht,{});const g=e.jsx(be,{onClick:()=>{v.logNewChatButtonClicked({location:"Mobile header"}),t()}});return f?e.jsx(rt,{layout:"compact",clientThreadId:s}):g}function Ht(){const t=J(),s=fe(Se.signUpButtonText);return e.jsx(A,{as:"button",size:"small",color:"primary",onClick:()=>{t({authType:"signup",callback:a=>{v.logSignUpButtonClicked({location:"Mobile Chat Stage Header",provider:a})}})},children:e.jsx(d,{...s})})}function qt(){const t=J();return e.jsx(A,{as:"button",size:"small",color:"primary",onClick:()=>{t({authType:"login",callback:s=>{v.logLogInButtonClicked({location:"Mobile Chat Stage Header",provider:s})}})},"data-testid":"mobile-login-button",children:e.jsx(d,{..._e.logInButtonText})})}function Vt({onClick:t}){return e.jsxs("button",{type:"button",className:"inline-flex rounded-md hover:text-token-text-primary focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white active:opacity-50",onClick:t,"data-testid":"open-sidebar-button",children:[e.jsx("span",{className:"sr-only",children:e.jsx(d,{...Se.openSidebar})}),e.jsx(it,{className:"icon-lg mx-2 text-token-text-secondary"})]})}const $t=({onClickOpenSidebar:t,children:s,showNavSidebar:a,leftContent:n,rightContent:i,bottomContent:r})=>{const u=Z(f=>f.activeSidebar),l=we(),m=l.pathname+l.search+l.hash;return o.useEffect(()=>{u==="popover-nav"&&T.setActiveSidebar(!1)},[m]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"draggable sticky top-0 z-10 flex min-h-[60px] items-center justify-center border-transparent bg-token-main-surface-primary pl-0 md:hidden",children:[(a||n)&&e.jsxs("div",{className:"no-draggable absolute bottom-0 left-0 top-0 ml-3 inline-flex items-center justify-center",children:[a&&e.jsx(Vt,{onClick:t}),n]}),e.jsx("div",{className:"no-draggable",children:s}),i&&e.jsx("div",{className:"no-draggable absolute bottom-0 right-0 top-0 mr-3 inline-flex items-center justify-center",children:i})]}),r&&e.jsx("div",{className:"no-draggable flex w-full items-center justify-center bg-token-main-surface-primary md:hidden",children:r})]})};function Gt({isPopoverOnDesktop:t=!1,isExpanded:s=!1,children:a}){const n=Ie();return z.markStart("StageNavigationSidebar"),z.markRendered("StageNavigationSidebar"),e.jsxs(e.Fragment,{children:[!n||t?e.jsx(Qt,{children:a}):null,e.jsx(Xt,{isExpanded:!t&&s,children:a})]})}function Xt({isExpanded:t,children:s}){const a=o.useRef(null);return t&&z.trackNamespace(z.NS_SIDEBAR),e.jsx(U.div,{className:S("z-[21] flex-shrink-0 overflow-x-hidden bg-token-sidebar-surface-primary max-md:!w-0"),ref:a,initial:!1,animate:{width:t?"260px":0,transition:{type:"spring",bounce:.12,duration:.64}},onAnimationStart:()=>{a.current&&(a.current.style.visibility="visible")},onAnimationComplete:()=>{a.current&&(t||(a.current.style.visibility="hidden"))},children:e.jsx("div",{className:"h-full w-[260px]",children:e.jsx("div",{className:"flex h-full min-h-0 flex-col",children:s})})})}function Qt({children:t}){const s=Z(a=>a.activeSidebar);return e.jsx(Ae,{open:s==="popover-nav",onOpenChange:a=>{a||T.setActiveSidebar(!1)},children:e.jsxs(Ue,{children:[e.jsx(Fe,{className:"fixed inset-0 z-10 bg-gray-50/50 radix-state-open:animate-show dark:bg-black/50"}),e.jsx(Be,{className:"fixed left-0 top-0 z-50 h-full max-w-xs border-r border-gray-200 bg-token-sidebar-surface-primary shadow-[0_0_64px_0_rgba(0,0,0,0.07)] focus:outline-none radix-state-closed:animate-sidebarHide radix-state-open:animate-sidebarShow top-banner-visible:bottom-0 top-banner-visible:top-[--top-banner-height,0px] top-banner-visible:h-auto dark:border-gray-800",children:t})]})})}const Se=H({closeSidebar:{id:"navigation.closeSidebar",defaultMessage:"Close sidebar"},openSidebar:{id:"navigation.openSidebar",defaultMessage:"Open sidebar"},signUpButtonText:{id:"navigation.signUpButtonText",defaultMessage:"Sign up"}});function Yt({showFreeTrialLoadingPayment:t,handleGetPaymentLink:s}){const a=F(),n=()=>{t||(R(!0),s())},i=p=>{p.stopPropagation(),ot(!0),lt(!0)},{data:r,isLoading:u,isSuccess:l}=Me({queryKey:["claimedReferralInvite"],queryFn:()=>le.getClaimedReferralInvite(),refetchOnMount:!1,refetchOnWindowFocus:!1,refetchInterval:!1,refetchOnReconnect:!1}),m=r?.invite_code,[f,g]=o.useState(!1);if(o.useEffect(()=>{m&&!f&&l&&(g(!0),D.logEvent("chatgpt_referral_show_claimed_sidebar_menu_promo"),v.logEvent(W.chatgptReferralShowClaimedSidebartMenuPromo))},[m,g,f,l]),!m||u||!l)return null;const c=m.invite_metadata.invite_data,x=c?.referral_trial_duration_months?c?.referral_trial_duration_months>1?a.formatMessage(X.monthsOfBenefit,{referralTrialDurationMonths:c?.referral_trial_duration_months}):a.formatMessage(X.daysOfBenefit,{referralTrialDurationDays:c?.referral_trial_duration_days}):null;return e.jsx(U.div,{className:S("relative",{"cursor-progress opacity-50":t}),layout:"position",initial:{y:-10,opacity:1},animate:{y:0,opacity:1,transition:{duration:.1,ease:"easeIn"}},children:e.jsxs(Kt,{className:S(t&&"opacity-75"),onClick:n,children:[e.jsxs("div",{className:"flex w-full flex-row items-center justify-start gap-3",children:[e.jsx(Ee,{className:"icon-sm shrink-0"}),e.jsx(d,{...X.freeTrialCta,values:{duration:x}})]}),!t&&e.jsx(Le,{onClick:i,className:"icon-md shrink-0 rounded-full p-0.5 text-token-text-tertiary opacity-50 transition-colors duration-200 hover:bg-[#0077FF] hover:text-red-500 group-hover:opacity-100"}),e.jsx("span",{className:"absolute top-11 h-0 w-0 border-l-8 border-r-8 border-t-8 border-l-transparent border-r-transparent border-t-[#0077FF] transition-colors duration-200 group-hover:border-t-[#0077FF]"})]})})}const Kt=oe.a`group relative mb-1 rounded-md hover:[#0077FF] bg-[#0077FF] flex px-3 min-h-[44px] py-1 items-center gap-3 transition-colors duration-200 dark:text-white cursor-pointer text-sm`,X=H({freeTrialCta:{id:"PaymentMenuItems.freeTrialCta",defaultMessage:"Get {duration}!"},monthsOfBenefit:{id:"FreeTrialMenuItem.monthsOfBenefit",defaultMessage:"{referralTrialDurationMonths, plural, one {one month free} other {# months free}}"},daysOfBenefit:{id:"FreeTrialMenuItem.daysOfBenefit",defaultMessage:"{referralTrialDurationDays, plural, one {one day free} other {# days free}}"}}),Jt=Re(()=>Oe(()=>import("./a81k56656r3wjnv3.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11])));function Zt(){const t=F(),s=De(),a=We(),{isLoading:n,data:i}=ze(),r=He(i),u=r?.hasPaidSubscription()??!1,l=r?.hasClaimedFreeTrial()??!1,m=o.useMemo(()=>r?.subscriptionAnalyticsParams,[r]),f=qe(),g=async()=>{R(!0),v.logEvent(W.accountPayPaymentCheckoutClicked,m);try{const h=await le.getCheckoutLink(a,"PaymentMenuItems");window.location.href=h.url}catch{s.warning(t.formatMessage(w.paymentErrorWarning),{hasCloseButton:!0}),R(!1)}finally{}},c=()=>{p||(R(!0),g())},x=se(h=>h.didCloseFreeTrial),p=se(h=>h.showFreeTrialLoadingPayment),y=!x&&l,M=r?.wasPaidCustomer()??!1;let j=r?.isWorkspaceAccount()??!1;const C=r?.hasPaidSubscription()??!1,N=r?.isPlus()??!1,k=i&&Ve(i),{layer:E}=ce("2670443078");let P=N;!j&&!N&&k&&E.get("is_gating_fix_enabled",!1)&&(P=k,j=!0);const q=!n&&!j,te=ie(),V=()=>{v.logEvent(W.accountPayClickSidebarAccountPay,m),ut(te,"Sidebar account payment menu item")};var $=r?.isTeam()??!1;return e.jsxs(e.Fragment,{children:[!u&&y&&e.jsx(Yt,{showFreeTrialLoadingPayment:p,handleGetPaymentLink:g}),$?e.jsx(es,{currentWorkspace:r}):null,q&&e.jsx(ve,{onClick:y?c:V,className:S("rounded-lg",f?"":"m-0 px-2"),children:e.jsx("span",{className:"flex w-full flex-row flex-wrap-reverse justify-between",children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(ts,{wasPaidCustomer:M,showFreeTrialLoadingPayment:p,hasPlusSubscription:P,hasPaidSubscription:C})})})})]})}const es=({currentWorkspace:t})=>e.jsxs(e.Fragment,{children:[e.jsx(ve,{onClick:()=>{T.openModal(ge.InviteUsersToWorkspace),v.logEvent(W.accountMemberInviteButton,{location:"payment-menu-click"}),D.logEvent("chatgpt_invite_users_to_workspace",0,{action:"OpenAdminInviteModal",location:"payment-menu-click",text:"AddTeammatesWithInfo",step:"OpenModal"})},className:"m-0 rounded-lg px-2",children:e.jsx("span",{className:"flex w-full flex-row flex-wrap-reverse justify-between",children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"flex h-7 w-7 items-center justify-center rounded-full border border-token-border-light",children:e.jsx(ct,{className:"icon-sm shrink-0"})}),e.jsx("div",{className:"flex flex-col",children:e.jsxs(e.Fragment,{children:[e.jsx("span",{children:e.jsx(d,{...w.addTeammates})}),e.jsx("span",{className:"line-clamp-1 text-xs text-token-text-tertiary",children:e.jsx(d,{...w.addTeammatesUpsell})})]})})]})})})}),t!=null?e.jsx(Jt,{workspace:t}):null]}),ts=({wasPaidCustomer:t,showFreeTrialLoadingPayment:s,hasPlusSubscription:a,hasPaidSubscription:n})=>s?e.jsx($e,{className:"icon-sm shrink-0"}):n&&!a?null:e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"flex h-7 w-7 shrink-0 items-center justify-center rounded-full border border-token-border-light",children:e.jsx(dt,{className:"icon-sm"})}),e.jsx("div",{className:"flex flex-col",children:t?e.jsx(d,{...w.renewPlus}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:a?e.jsx(d,{...w.viewPlans}):!n&&e.jsx(d,{...w.upgradePlan})}),e.jsx("span",{className:"line-clamp-1 text-xs text-token-text-tertiary",children:a?e.jsx(d,{...w.upgradeToProOrTeamUpsell}):!n&&e.jsx(d,{...w.upgradeToPlusUpsell})})]})})]}),w=H({upgradePlan:{id:"PaymentMenuItems.upgradePlan",defaultMessage:"Upgrade plan"},createATeamWorkspace:{id:"PaymentMenuItems.createATeamWorkspace",defaultMessage:"Add Team workspace"},viewPlans:{id:"PaymentMenuItems.viewPlans",defaultMessage:"View plans"},upgradeToTeamUpsell:{id:"PaymentMenuItems.upgradeToTeamUpsell",defaultMessage:"Collaborate on a Team plan"},upgradeToProOrTeamUpsell:{id:"PaymentMenuItems.upgradeToProOrTeamUpsell",defaultMessage:"Unlimited access, team features, and more"},upgradeToPlusUpsell:{id:"PaymentMenuItems.upgradeToPlusUpsell.0",defaultMessage:"More access to the best models"},renewPlus:{id:"PaymentMenuItems.renewPlus",defaultMessage:"Renew Plus"},inviteReferral:{id:"PaymentMenuItems.inviteReferral",defaultMessage:"Refer a friend"},addTeammates:{id:"PaymentMenuItems.addTeammates.0",defaultMessage:"Add teammates"},addTeammatesUpsell:{id:"PaymentMenuItems.addTeammatesUpsell.0",defaultMessage:"Invite coworkers to ChatGPT"},inviteMembers:{id:"PaymentMenuItems.inviteMembers.0",defaultMessage:"Invite members"},paymentErrorWarning:{id:"PaymentMenuItems.paymentErrorWarning",defaultMessage:"The payments page encountered an error. Please try again. If the problem continues, please visit help.openai.com."}});function Ts({navHeader:t,children:s,className:a}){const n=F(),i=o.useRef(null),r=Ge(),u=me(),l=r&&!u,{isUnauthenticated:m}=B(),{layer:f}=ce("1578749296"),g=f.get("is_sticky_toggle_off",!1);return o.useEffect(()=>{g&&T.toggleDesktopNavCollapsed()},[g]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"draggable relative h-full w-full flex-1 items-start border-white/20",children:[e.jsx(Xe,{asChild:!0,children:e.jsx("h2",{children:e.jsx(d,{..._.chatHistoryLabel})})}),e.jsxs("nav",{className:S("flex h-full w-full flex-col px-3",a),"aria-label":n.formatMessage(_.chatHistoryLabel),children:[t,e.jsx(as,{ref:i,$disableScroll:l&&!m,children:s}),e.jsx(L,{children:e.jsx(ss,{})})]})]})})}function ss(){const[t]=o.useState(()=>{const r=Qe.getCookie(Ye.Workspace);return typeof r=="string"&&r!==Ke}),s=Je(),a=s?.data==null,{isUnauthenticated:n}=B(),{openSettings:i}=he();return t&&a||!s?null:n?e.jsx(ye,{}):e.jsxs("div",{className:S("flex flex-col py-2 empty:hidden dark:border-white/20"),children:[e.jsx(mt,{}),e.jsx(Zt,{}),e.jsx("div",{className:"flex w-full items-center md:hidden",children:e.jsx("div",{className:"max-w-[100%] grow",children:e.jsx(zt,{onClickSettings:()=>i()})})})]})}const ye=()=>{const t=ue(),s=J(),a=fe(_.unauthSignupCta),n=()=>{s({authType:"login",callback:l=>{v.logLogInButtonClicked({location:"Sidebar bottom unit",provider:l}),D.logEvent("chatgpt_sidebar_login_button_clicked")}})},i=()=>{s({authType:"signup",callback:l=>{v.logSignUpButtonClicked({location:"Sidebar bottom unit",provider:l}),D.logEvent("chatgpt_sidebar_signup_button_clicked")}})},r=e.jsx(A,{as:"button",size:"medium",color:t?"secondary":"primary","data-testid":"signup-button",onClick:i,children:e.jsx(d,{...a})},"signup-button"),u=e.jsx(A,{as:"button",size:"medium",color:t?"primary":"secondary","data-testid":"login-button",onClick:n,children:e.jsx(d,{..._.unauthLoginCta})},"login-button");return e.jsxs("div",{className:"p-2",children:[e.jsxs("div",{className:"mb-4 mt-2",children:[e.jsx("p",{className:"mb-1 text-sm font-semibold text-token-text-primary",children:e.jsx(d,{...t?_.logInOrSignUp:_.signUpOrLogIn})}),e.jsx("p",{className:"text-sm text-token-text-secondary",children:e.jsx(d,{id:"4qlPtW",defaultMessage:"Get smarter responses, upload files and images, and more."})})]}),e.jsx("div",{className:"flex flex-row items-start gap-2",children:t?[u,r]:[r,u]})]})},as=oe.div`flex-col flex-1 transition-opacity duration-500 relative -mr-2 pr-2
  ${({$disableScroll:t})=>t?"overflow-y-hidden opacity-20 pointer-events-none":"overflow-y-auto"}`,_=H({chatHistoryLabel:{id:"NavigationContent.chatHistoryLabel",defaultMessage:"Chat history"},closeSidebar:{id:"NavigationContent.closeSidebar",defaultMessage:"Close sidebar"},signInToChat:{id:"NavigationContent.signInToChat",defaultMessage:"Sign in to ChatGPT"},signUpOrLogIn:{id:"NavigationContent.signUpOrLogIn",defaultMessage:"Sign up or log in"},logInOrSignUp:{id:"NavigationContent.logInOrSignUp",defaultMessage:"Log in or sign up"},unauthSignupCta:{id:"NavigationContent.unauthSignupCta",defaultMessage:"Sign up"},unauthLoginCta:{id:"NavigationContent.unauthLoginCta",defaultMessage:"Log in"}}),ns=()=>{const{openSettings:t}=he(),s=et("3376455464")?.value,a=ie();return e.jsxs("div",{className:"flex h-full flex-col gap-2 p-3",children:[e.jsx(ae,{icon:ft,onClick:()=>{gt(a),T.closeActiveSidebar()},children:e.jsx(d,{id:"0FupYP",defaultMessage:"New chat"})}),e.jsx("div",{className:"flex grow items-center justify-center",children:e.jsx(ye,{})}),e.jsxs(Ze,{contentClassName:"w-[298px]",triggerButton:e.jsx(ae,{icon:ht,children:e.jsx(d,{id:"y4Lkp7",defaultMessage:"Settings and more"})}),children:[e.jsx(G.Item,{onClick:()=>t(),icon:xt,children:e.jsx(d,{id:"HrRLkZ",defaultMessage:"Settings"})}),s&&e.jsx(G.Item,{icon:pt,onClick:()=>{T.openModal(ge.ReportConversation)},children:e.jsx(d,{id:"thread.report.0",defaultMessage:"Report illegal content"})}),e.jsx(G.Separator,{}),e.jsx(jt,{})]})]})};function rs({children:t}){return e.jsx("div",{className:"h-full w-full bg-token-main-surface-primary px-[22px] py-4",children:t})}function is(){return e.jsxs("div",{className:"flex w-full gap-2",children:[e.jsx("div",{className:"h-6 w-6",children:e.jsx(I,{className:"h-full w-full !rounded-full"})}),e.jsxs("div",{className:"flex w-full flex-col gap-2",children:[e.jsx(I,{}),e.jsx(I,{}),e.jsx(I,{}),e.jsx(I,{})]})]})}function Q({icon:t,message:s,iconClassName:a}){return e.jsx("div",{className:"loading-shimmer-pure-text flex h-8 gap-1 overflow-hidden",children:e.jsx(ee,{fillIcon:!1,icon:t,className:a,children:e.jsx("div",{className:"mt-[.5px] flex h-10",children:s})})})}const os=({finalRow:t})=>{const s=F();return e.jsx(K,{children:e.jsx(U.div,{layout:!0,transition:{type:"spring",stiffness:300,damping:30},className:"flex flex-col items-start justify-start gap-4",children:t.type==="search"?e.jsx(Q,{icon:e.jsx(xe,{className:"relative h-5 w-5 text-token-text-primary opacity-50"}),message:s.formatMessage({id:"f9wsyE",defaultMessage:"Searching…"})}):t.type==="summary"?e.jsx(Q,{icon:e.jsx(de,{className:"inline-flex h-5 w-5 items-center justify-center opacity-50"}),message:s.formatMessage({id:"bSPYmC",defaultMessage:"Thinking…"})}):e.jsx(Q,{icon:e.jsx(bt,{className:"inline-flex h-5 w-5 items-center justify-center opacity-50"}),message:s.formatMessage({id:"8L6BBp",defaultMessage:"Reading…"})})})})},ls=({children:t,showIcon:s})=>e.jsxs("div",{className:"flex items-start gap-2 text-wrap text-start",children:[e.jsx("div",{className:"mt-[1px] inline-flex h-5 w-5 shrink-0 items-center justify-end gap-2.5 pt-[3px]",children:s&&e.jsx(xe,{className:"relative h-5 w-5 text-token-text-primary"})}),t]}),cs=({row:t,showIcon:s})=>{const a=t.query;return a?e.jsx(ls,{showIcon:s,children:e.jsx("div",{className:"flex text-base text-token-text-primary",children:a})}):null};function Y({children:t}){return e.jsx(U.div,{className:"w-full",initial:{opacity:0},animate:{opacity:1},transition:{duration:1},children:t})}const ds=({previousRow:t,currentRow:s})=>e.jsx("div",{className:"flex flex-col items-start justify-start gap-4",children:s.type==="search"?e.jsx(Y,{children:e.jsx(cs,{row:s,showIcon:!t||t.type!=="search"})},`search_${s.id}`):s.type==="summary"?e.jsx(Y,{children:e.jsx(vt,{row:s,showIcon:!t||t.type!=="summary"})},`summary_${s.id}`):s.type==="websiteOpen"?e.jsx(Y,{children:e.jsx(St,{website:s})},`website_${s.id}`):null}),us=120,ms=1e3*60*2;function re(t){t?.scrollIntoView({block:"center",behavior:"smooth"})}function fs({caterpillarStatusMessageTexts:t}){return e.jsx("div",{className:"p-4",children:e.jsx(pe,{type:"error",title:t.failureMessage,content:t.failureBannerContentMessage})})}function gs({caterpillarStatusMessageTexts:t}){return e.jsx("div",{className:"p-4",children:e.jsx(pe,{title:t.cancelledMessage,content:""})})}function hs({interruptPrompt:t,setInterruptPrompt:s,handleInterruptCaterpillar:a}){const n=F();return e.jsxs("div",{className:"flex w-full flex-col justify-center gap-4 p-4",children:[e.jsx(Nt,{ariaLabel:n.formatMessage({id:"aYWRtV",defaultMessage:"Press enter to interrupt task"}),name:"interrupt-caterpillar-prompt",value:t,onChange:i=>s(i.target.value),color:"search",onPressEnter:a}),e.jsx(A,{onClick:a,children:e.jsx(d,{id:"h73FdF",defaultMessage:"Interrupt task"})})]})}function xs({sourcesCount:t,taskInfo:s}){const n=kt(s.originalConversationId).find(r=>r.message.metadata?.b1de6e2_s&&r.message.metadata?.async_task_id===s.taskId)?.message,i=o.useMemo(()=>n?.metadata?.async_task_status_messages?.completed_no_time?e.jsxs(e.Fragment,{children:[n.metadata?.async_task_status_messages?.completed_with_time??n?.metadata?.async_task_status_messages?.completed_no_time,e.jsx(d,{id:"zxfmo/",defaultMessage:" · {sourcesCount} sources",values:{sourcesCount:t}})]}):e.jsx(d,{id:"YG7a0T",defaultMessage:"Completed · {sourcesCount} sources",values:{sourcesCount:t}}),[t,n]);return!s.updatedAt&&!n?.metadata?.async_task_status_messages?.completed?null:e.jsx(ee,{icon:e.jsx(st,{className:"text-token-text-secondary"}),fillIcon:!1,children:e.jsx("div",{className:"text-token-text-tertiary",children:i})})}function ps({taskInfo:t,caterpillarStatusMessageTexts:s,sourcesCount:a,caterpillarHeaderRef:n}){const[i,r]=o.useState(""),[u,l]=o.useState(!1),m=tt("caterpillar-interrupts"),f=o.useRef(!1),g=o.useRef(null),c=o.useMemo(()=>(f.current=!!g.current&&yt(g.current,us),t.rows??[]),[t.rows]);o.useEffect(()=>{if(c.length===0){const j=new Date(t.createdAt).getTime(),C=Date.now()-j,N=ms-C;if(N>0){const k=setTimeout(()=>{l(!0)},N);return()=>clearTimeout(k)}else l(!0)}else l(!1)},[c,t.createdAt]),o.useEffect(()=>{f.current&&re(g.current)},[c]),o.useEffect(()=>{ne(t)||setTimeout(()=>{g.current&&re(g.current)},100)},[]);const x=Ct({taskId:t.taskId,prompt:i}),p=ne(t)||wt(t),y=o.useCallback(async()=>{await x.mutateAsync(),r("")},[x,r]),M=o.useMemo(()=>c.length?p?c:c.slice(0,c.length-1):c,[c,p]);return e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{ref:n},"task-header"),e.jsxs("div",{className:"flex w-full flex-col gap-4",children:[e.jsx("div",{className:"text-base font-medium",children:t.title}),c.length?e.jsxs(K,{initial:!1,children:[M.map((j,C)=>e.jsx(ds,{previousRow:C>0?c[C-1]:null,currentRow:j},j.id)),!p&&e.jsx(os,{finalRow:c[c.length-1]})]}):u?e.jsx(ee,{fillIcon:!1,icon:e.jsx(de,{className:"inline-flex h-5 w-5 items-center justify-center text-token-text-primary"}),children:s.waitingInQueueMessage}):e.jsx(is,{}),Mt(t)&&m&&e.jsx(hs,{interruptPrompt:i,setInterruptPrompt:r,handleInterruptCaterpillar:y}),t.status==="failed"?e.jsx(fs,{caterpillarStatusMessageTexts:s}):t.status==="cancelled"?e.jsx(gs,{caterpillarStatusMessageTexts:s}):t.status==="completed"?e.jsx(xs,{caterpillarStatusMessageTexts:s,taskInfo:t,sourcesCount:a}):null]}),e.jsx("div",{ref:g},"task-footer")]})}function js({taskId:t,setWidth:s=void 0,initialTab:a}){const n=Tt(x=>Pt.getTask(t,x)),{closeThreadSidebar:i}=at(),[r,u]=o.useState(a),l=_t(),m=o.useRef(null),f=!1;o.useEffect(()=>{u(a)},[a]),o.useEffect(()=>{},[n?.taskId,n?.status,f]),o.useEffect(()=>{},[n?.taskId,n?.status,r]),o.useEffect(()=>{},[s,n,f]);const{uniqueSources:g,totalSources:c}=o.useMemo(()=>{if(!n?.rows)return{uniqueSources:[],totalSources:0};const x=It(n.rows),p=x.reduce((y,M)=>y+M.count,0);return{uniqueSources:x,totalSources:p}},[n?.rows]);return e.jsx(At,{handleClose:()=>i({}),leading:e.jsx("div",{className:"flex w-full justify-center",children:e.jsx(Ut,{activeTab:r,setActiveTab:u,showAuxTab:f,sourcesCount:c,caterpillarHeaderRef:m})}),children:n&&e.jsxs(rs,{children:[!1,r==="activity"&&e.jsx(ps,{taskInfo:n,caterpillarStatusMessageTexts:l,sourcesCount:c,caterpillarHeaderRef:m}),r==="sources"&&e.jsx(Ft,{taskInfo:n,sources:g,caterpillarHeaderRef:m})]})})}function bs({isExpanded:t,children:s}){const a=o.useRef(null),[n,i]=o.useState("400px"),r=O.isValidElement(s)?O.cloneElement(s,{setWidth:i}):s;return e.jsx(K,{children:e.jsx(U.div,{className:"z-[1] flex-shrink-0 overflow-x-hidden bg-token-sidebar-surface-primary max-md:!w-0",ref:a,initial:!1,animate:{width:t?n:0,transition:{type:"spring",bounce:.12,duration:.3}},onAnimationStart:()=>{a.current&&(a.current.style.visibility="visible")},onAnimationComplete:()=>{a.current&&(t||(a.current.style.visibility="hidden"))},children:e.jsx("div",{className:S("absolute h-full",!t&&"pointer-events-none"),style:{width:n},children:e.jsx("div",{className:"flex h-full flex-col",children:r})})})})}const Ps=({setWidth:t,clientThreadId:s})=>{const a=b("caterpillar"),n=b("searchSources"),i=b("summarizer"),r=b("retrievalResults"),u=b("product"),l=je();return e.jsxs(e.Fragment,{children:[n&&e.jsx(Bt,{clientThreadId:s}),r&&e.jsx(Et,{clientThreadId:s}),l&&i&&e.jsx(Lt,{clientThreadId:s}),a&&e.jsx(js,{taskId:a.caterpillarId,initialTab:a.initialTab,setWidth:t}),u&&!1]})};function Ce({children:t,hideNavigation:s=!1,mobileHeaderContent:a,mobileHeaderLeftContent:n,mobileHeaderRightContent:i,mobileHeaderBottomContent:r,sidebar:u,threadFlyout:l,forceOpenDesktopSidebar:m=!1}){const{isUnauthenticated:f}=B(),[g,c]=Z(h=>[h.activeStageSidebar,h.activeSidebar]),x=nt(),p=b("searchSources"),y=b("summarizer"),M=b("retrievalResults"),j=b("caterpillar"),C=b("product"),N=Rt(),k=[];let E=null;O.Children.forEach(t,h=>{O.isValidElement(h)&&(h.type===Ce.Sidebars?E=h:k.push(h))});const P=!f&&!s&&u!=null,q=!s&&(P||f),V=je()&&!!y,$=x&&(!!p||V||!!M||!!j||!!C);return e.jsxs("div",{className:"flex h-full w-full flex-col",children:[e.jsx(L,{children:e.jsx(Ot,{})}),e.jsxs("div",{className:S("relative flex h-full w-full flex-1 overflow-hidden transition-colors",c!=="popover-nav"&&"z-0"),children:[e.jsxs("div",{className:"relative flex h-full w-full flex-row overflow-hidden",children:[P&&e.jsx(Gt,{isExpanded:m||!N,isPopoverOnDesktop:g,children:f?e.jsx(ns,{}):u}),e.jsxs("div",{className:"relative flex h-full max-w-full flex-1 flex-col overflow-hidden",children:[q&&e.jsxs(L,{children:[e.jsx(Dt,{}),e.jsx($t,{onClickOpenSidebar:()=>T.togglePopoverNavSidebar(),showNavSidebar:P,leftContent:n,rightContent:i,bottomContent:r,children:a})]}),e.jsx("main",{className:"relative h-full w-full flex-1 overflow-auto transition-width",children:k})]})]}),e.jsx(L,{children:e.jsx(bs,{isExpanded:$,children:l})}),E]})]})}function vs({children:t}){return e.jsx(e.Fragment,{children:t})}Ce.Sidebars=vs;export{js as C,Ps as F,Ts as N,Zt as P,Ce as S,ye as U,Ns as a,ks as b,Ms as c};
//# sourceMappingURL=hjbk0a4n40hheieo.js.map
